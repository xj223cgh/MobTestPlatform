/* empty css                  *//* empty css                   */import{E as e,a}from"./el-descriptions-item-e887b571.js";import{E as l}from"./el-overlay-71eaae9d.js";import{E as t,a as s}from"./el-input-89ea148f.js";import{g as o,a as d,d as r,u as i,c as n,E as u}from"./device-8c76a684.js";import{E as p,a as c}from"./el-radio-group-56c94ad0.js";import{E as m}from"./el-pagination-aa6134da.js";import{E as f}from"./el-tag-418c1d1c.js";import{a as _,E as v}from"./el-select-b829cea3.js";import"./el-scrollbar-0528a0c4.js";import{E as b,a as y}from"./el-table-column-5340bcc8.js";import"./el-checkbox-14904d7f.js";import"./el-tooltip-4ed993c7.js";import{E as g,a as h}from"./el-col-538f99f5.js";import{r as V,b as j,o as w,c as C,d as k,e as x,f as U,w as z,a5 as O,J as E,n as I,l as A,h as S,aB as q,j as D,aD as P,m as Y,L as B,aR as $,aW as F,i as M,aC as H,aq as J,ao as K,E as L,k as R}from"./index-cd351671.js";import{d as T}from"./dayjs.min-fd58e32d.js";import{_ as N}from"./_plugin-vue_export-helper-1b428a4d.js";import{v as Q}from"./directive-1c779a20.js";import"./refs-9112775b.js";import"./castArray-824cd328.js";import"./index-6e95e63b.js";import"./omit-7b0b3aa9.js";import"./strings-b003b1cc.js";import"./raf-907dd12a.js";const W={class:"device-management"},G={class:"page-header"},X={class:"header-actions"},Z={class:"stats-section"},ee={class:"stat-card"},ae={class:"stat-icon online"},le={class:"stat-content"},te={class:"stat-number"},se={class:"stat-card"},oe={class:"stat-icon offline"},de={class:"stat-content"},re={class:"stat-number"},ie={class:"stat-card"},ne={class:"stat-icon busy"},ue={class:"stat-content"},pe={class:"stat-number"},ce={class:"stat-card"},me={class:"stat-icon total"},fe={class:"stat-content"},_e={class:"stat-number"},ve={class:"search-section"},be={class:"table-section"},ye={class:"pagination"},ge={class:"dialog-footer"},he={key:0,class:"device-detail"},Ve=N({__name:"DeviceManagement",setup(N){const Ve=V(!1),je=V(!1),we=V(!1),Ce=V(!1),ke=V(!1),xe=V(""),Ue=V(),ze=V(null),Oe=j({online:0,offline:0,busy:0,total:0}),Ee=j({name:"",type:"",status:""}),Ie=j({id:null,name:"",type:"",platform:"android",os_version:"",ip_address:"",port:5555,description:""}),Ae={name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],type:[{required:!0,message:"请选择设备类型",trigger:"change"}],platform:[{required:!0,message:"请选择平台",trigger:"change"}],os_version:[{required:!0,message:"请输入系统版本",trigger:"blur"}],ip_address:[{required:!0,message:"请输入IP地址",trigger:"blur"},{pattern:/^(\d{1,3}\.){3}\d{1,3}$/,message:"请输入正确的IP地址",trigger:"blur"}],port:[{required:!0,message:"请输入端口号",trigger:"blur"}]},Se=V([]),qe=j({page:1,size:10,total:0}),De=async()=>{Ve.value=!0;try{const e={page:qe.page,size:qe.size,...Ee},a=await o(e);a.success?(Se.value=a.data.list,qe.total=a.data.total):I.error(a.message||"获取设备列表失败")}catch(e){console.error("获取设备列表失败:",e),I.error("获取设备列表失败")}finally{Ve.value=!1}},Pe=async()=>{try{const e=await d();e.success&&Object.assign(Oe,e.data)}catch(e){console.error("获取设备统计失败:",e)}},Ye=()=>{qe.page=1,De()},Be=()=>{Object.assign(Ee,{name:"",type:"",status:""}),Ye()},$e=()=>{De(),Pe(),I.success("状态已刷新")},Fe=()=>{ke.value=!1,xe.value="添加设备",we.value=!0,He()},Me=async()=>{if(Ue.value)try{let e;await Ue.value.validate(),je.value=!0,e=ke.value?await i(Ie.id,Ie):await n(Ie),e.success?(I.success(ke.value?"更新成功":"创建成功"),we.value=!1,De(),Pe()):I.error(e.message||"操作失败")}catch(e){console.error("提交失败:",e),I.error("操作失败")}finally{je.value=!1}},He=()=>{Object.assign(Ie,{id:null,name:"",type:"",platform:"android",os_version:"",ip_address:"",port:5555,description:""}),Ue.value&&Ue.value.resetFields()},Je=e=>{qe.size=e,qe.page=1,De()},Ke=e=>{qe.page=e,De()},Le=e=>({android_phone:"Android手机",ios_phone:"iOS手机",android_tablet:"Android平板",ios_tablet:"iOS平板"}[e]||e),Re=e=>({android_phone:"success",ios_phone:"primary",android_tablet:"warning",ios_tablet:"info"}[e]||"info"),Te=e=>({online:"在线",offline:"离线",busy:"忙碌",maintenance:"维护"}[e]||e),Ne=e=>({online:"success",offline:"danger",busy:"warning",maintenance:"info"}[e]||"info"),Qe=e=>e?T(e).format("YYYY-MM-DD HH:mm:ss"):"-";return w(()=>{De(),Pe()}),(o,d)=>{const i=L,n=A,V=h,j=g,w=R,T=s,N=_,He=v,We=t,Ge=y,Xe=f,Ze=b,ea=m,aa=p,la=c,ta=u,sa=l,oa=e,da=a,ra=Q;return C(),k("div",W,[x("div",G,[d[15]||(d[15]=x("div",{class:"header-content"},[x("h1",null,"设备管理"),x("p",{class:"description"},"管理测试设备和设备状态")],-1)),x("div",X,[U(n,{type:"primary",onClick:Fe},{default:z(()=>[U(i,null,{default:z(()=>[U(S(q))]),_:1}),d[13]||(d[13]=D(" 添加设备 ",-1))]),_:1}),U(n,{onClick:$e},{default:z(()=>[U(i,null,{default:z(()=>[U(S(P))]),_:1}),d[14]||(d[14]=D(" 刷新状态 ",-1))]),_:1})])]),x("div",Z,[U(j,{gutter:20},{default:z(()=>[U(V,{span:6},{default:z(()=>[x("div",ee,[x("div",ae,[U(i,null,{default:z(()=>[U(S(Y))]),_:1})]),x("div",le,[x("div",te,B(Oe.online),1),d[16]||(d[16]=x("div",{class:"stat-label"},"在线设备",-1))])])]),_:1}),U(V,{span:6},{default:z(()=>[x("div",se,[x("div",oe,[U(i,null,{default:z(()=>[U(S(Y))]),_:1})]),x("div",de,[x("div",re,B(Oe.offline),1),d[17]||(d[17]=x("div",{class:"stat-label"},"离线设备",-1))])])]),_:1}),U(V,{span:6},{default:z(()=>[x("div",ie,[x("div",ne,[U(i,null,{default:z(()=>[U(S($))]),_:1})]),x("div",ue,[x("div",pe,B(Oe.busy),1),d[18]||(d[18]=x("div",{class:"stat-label"},"忙碌设备",-1))])])]),_:1}),U(V,{span:6},{default:z(()=>[x("div",ce,[x("div",me,[U(i,null,{default:z(()=>[U(S(F))]),_:1})]),x("div",fe,[x("div",_e,B(Oe.total),1),d[19]||(d[19]=x("div",{class:"stat-label"},"设备总数",-1))])])]),_:1})]),_:1})]),x("div",ve,[U(We,{model:Ee,inline:""},{default:z(()=>[U(T,{label:"设备名称"},{default:z(()=>[U(w,{modelValue:Ee.name,"onUpdate:modelValue":d[0]||(d[0]=e=>Ee.name=e),placeholder:"请输入设备名称",clearable:"",onClear:Ye,onKeyup:M(Ye,["enter"])},null,8,["modelValue"])]),_:1}),U(T,{label:"设备类型"},{default:z(()=>[U(He,{modelValue:Ee.type,"onUpdate:modelValue":d[1]||(d[1]=e=>Ee.type=e),placeholder:"请选择设备类型",clearable:"",onClear:Ye,onChange:Ye},{default:z(()=>[U(N,{label:"Android手机",value:"android_phone"}),U(N,{label:"iOS手机",value:"ios_phone"}),U(N,{label:"Android平板",value:"android_tablet"}),U(N,{label:"iOS平板",value:"ios_tablet"})]),_:1},8,["modelValue"])]),_:1}),U(T,{label:"状态"},{default:z(()=>[U(He,{modelValue:Ee.status,"onUpdate:modelValue":d[2]||(d[2]=e=>Ee.status=e),placeholder:"请选择状态",clearable:"",onClear:Ye,onChange:Ye},{default:z(()=>[U(N,{label:"在线",value:"online"}),U(N,{label:"离线",value:"offline"}),U(N,{label:"忙碌",value:"busy"}),U(N,{label:"维护",value:"maintenance"})]),_:1},8,["modelValue"])]),_:1}),U(T,null,{default:z(()=>[U(n,{type:"primary",onClick:Ye},{default:z(()=>[U(i,null,{default:z(()=>[U(S(H))]),_:1}),d[20]||(d[20]=D(" 搜索 ",-1))]),_:1}),U(n,{onClick:Be},{default:z(()=>[U(i,null,{default:z(()=>[U(S(P))]),_:1}),d[21]||(d[21]=D(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),x("div",be,[O((C(),E(Ze,{data:Se.value,stripe:"",border:"",style:{width:"100%"}},{default:z(()=>[U(Ge,{prop:"id",label:"ID",width:"80"}),U(Ge,{prop:"name",label:"设备名称","min-width":"150"}),U(Ge,{prop:"type",label:"设备类型",width:"120"},{default:z(({row:e})=>[U(Xe,{type:Re(e.type)},{default:z(()=>[D(B(Le(e.type)),1)]),_:2},1032,["type"])]),_:1}),U(Ge,{prop:"platform",label:"平台",width:"80"},{default:z(({row:e})=>[U(Xe,{type:"android"===e.platform?"success":"primary"},{default:z(()=>[D(B(e.platform.toUpperCase()),1)]),_:2},1032,["type"])]),_:1}),U(Ge,{prop:"os_version",label:"系统版本",width:"100"}),U(Ge,{prop:"status",label:"状态",width:"100"},{default:z(({row:e})=>[U(Xe,{type:Ne(e.status)},{default:z(()=>[D(B(Te(e.status)),1)]),_:2},1032,["type"])]),_:1}),U(Ge,{prop:"ip_address",label:"IP地址",width:"130"}),U(Ge,{prop:"last_seen",label:"最后在线",width:"160"},{default:z(({row:e})=>[D(B(Qe(e.last_seen)),1)]),_:1}),U(Ge,{label:"操作",width:"250",fixed:"right"},{default:z(({row:e})=>[U(n,{type:"primary",size:"small",onClick:a=>(e=>{ze.value=e,Ce.value=!0})(e)},{default:z(()=>[...d[22]||(d[22]=[D(" 查看 ",-1)])]),_:1},8,["onClick"]),U(n,{type:"success",size:"small",onClick:a=>(e=>{I.success(`正在连接设备: ${e.name}`)})(e),disabled:"online"!==e.status},{default:z(()=>[...d[23]||(d[23]=[D(" 连接 ",-1)])]),_:1},8,["onClick","disabled"]),U(n,{type:"warning",size:"small",onClick:a=>(e=>{ke.value=!0,xe.value="编辑设备",we.value=!0,Object.assign(Ie,{id:e.id,name:e.name,type:e.type,platform:e.platform,os_version:e.os_version,ip_address:e.ip_address,port:e.port,description:e.description})})(e)},{default:z(()=>[...d[24]||(d[24]=[D(" 编辑 ",-1)])]),_:1},8,["onClick"]),U(n,{type:"danger",size:"small",onClick:a=>(e=>{K.confirm(`确定要删除设备 "${e.name}" 吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const a=await r(e.id);a.success?(I.success("删除成功"),De(),Pe()):I.error(a.message||"删除失败")}catch(a){console.error("删除设备失败:",a),I.error("删除失败")}})})(e)},{default:z(()=>[...d[25]||(d[25]=[D(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ra,Ve.value]]),x("div",ye,[U(ea,{"current-page":"pagination.page","page-size":"pagination.size",total:qe.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Je,onCurrentChange:Ke},null,8,["total"])])]),U(sa,{modelValue:we.value,"onUpdate:modelValue":d[11]||(d[11]=e=>we.value=e),title:xe.value,width:"600px","close-on-click-modal":!1},{footer:z(()=>[x("span",ge,[U(n,{onClick:d[10]||(d[10]=e=>we.value=!1)},{default:z(()=>[...d[28]||(d[28]=[D("取消",-1)])]),_:1}),U(n,{type:"primary",loading:je.value,onClick:Me},{default:z(()=>[...d[29]||(d[29]=[D(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:z(()=>[U(We,{ref_key:"deviceFormRef",ref:Ue,model:Ie,rules:Ae,"label-width":"100px"},{default:z(()=>[U(T,{label:"设备名称",prop:"name"},{default:z(()=>[U(w,{modelValue:Ie.name,"onUpdate:modelValue":d[3]||(d[3]=e=>Ie.name=e),placeholder:"请输入设备名称"},null,8,["modelValue"])]),_:1}),U(T,{label:"设备类型",prop:"type"},{default:z(()=>[U(He,{modelValue:Ie.type,"onUpdate:modelValue":d[4]||(d[4]=e=>Ie.type=e),placeholder:"请选择设备类型"},{default:z(()=>[U(N,{label:"Android手机",value:"android_phone"}),U(N,{label:"iOS手机",value:"ios_phone"}),U(N,{label:"Android平板",value:"android_tablet"}),U(N,{label:"iOS平板",value:"ios_tablet"})]),_:1},8,["modelValue"])]),_:1}),U(T,{label:"平台",prop:"platform"},{default:z(()=>[U(la,{modelValue:Ie.platform,"onUpdate:modelValue":d[5]||(d[5]=e=>Ie.platform=e)},{default:z(()=>[U(aa,{label:"android"},{default:z(()=>[...d[26]||(d[26]=[D("Android",-1)])]),_:1}),U(aa,{label:"ios"},{default:z(()=>[...d[27]||(d[27]=[D("iOS",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),U(T,{label:"系统版本",prop:"os_version"},{default:z(()=>[U(w,{modelValue:Ie.os_version,"onUpdate:modelValue":d[6]||(d[6]=e=>Ie.os_version=e),placeholder:"请输入系统版本"},null,8,["modelValue"])]),_:1}),U(T,{label:"IP地址",prop:"ip_address"},{default:z(()=>[U(w,{modelValue:Ie.ip_address,"onUpdate:modelValue":d[7]||(d[7]=e=>Ie.ip_address=e),placeholder:"请输入IP地址"},null,8,["modelValue"])]),_:1}),U(T,{label:"端口",prop:"port"},{default:z(()=>[U(ta,{modelValue:Ie.port,"onUpdate:modelValue":d[8]||(d[8]=e=>Ie.port=e),min:1,max:65535,placeholder:"请输入端口号"},null,8,["modelValue"])]),_:1}),U(T,{label:"描述",prop:"description"},{default:z(()=>[U(w,{modelValue:Ie.description,"onUpdate:modelValue":d[9]||(d[9]=e=>Ie.description=e),type:"textarea",rows:3,placeholder:"请输入设备描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),U(sa,{modelValue:Ce.value,"onUpdate:modelValue":d[12]||(d[12]=e=>Ce.value=e),title:"设备详情",width:"800px"},{default:z(()=>[ze.value?(C(),k("div",he,[U(da,{column:2,border:""},{default:z(()=>[U(oa,{label:"设备ID"},{default:z(()=>[D(B(ze.value.id),1)]),_:1}),U(oa,{label:"设备名称"},{default:z(()=>[D(B(ze.value.name),1)]),_:1}),U(oa,{label:"设备类型"},{default:z(()=>[U(Xe,{type:Re(ze.value.type)},{default:z(()=>[D(B(Le(ze.value.type)),1)]),_:1},8,["type"])]),_:1}),U(oa,{label:"平台"},{default:z(()=>[U(Xe,{type:"android"===ze.value.platform?"success":"primary"},{default:z(()=>[D(B(ze.value.platform.toUpperCase()),1)]),_:1},8,["type"])]),_:1}),U(oa,{label:"系统版本"},{default:z(()=>[D(B(ze.value.os_version),1)]),_:1}),U(oa,{label:"状态"},{default:z(()=>[U(Xe,{type:Ne(ze.value.status)},{default:z(()=>[D(B(Te(ze.value.status)),1)]),_:1},8,["type"])]),_:1}),U(oa,{label:"IP地址"},{default:z(()=>[D(B(ze.value.ip_address),1)]),_:1}),U(oa,{label:"端口"},{default:z(()=>[D(B(ze.value.port),1)]),_:1}),U(oa,{label:"最后在线"},{default:z(()=>[D(B(Qe(ze.value.last_seen)),1)]),_:1}),U(oa,{label:"创建时间"},{default:z(()=>[D(B(Qe(ze.value.created_at)),1)]),_:1}),U(oa,{label:"描述",span:2},{default:z(()=>[D(B(ze.value.description||"-"),1)]),_:1})]),_:1})])):J("",!0)]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-ef31403b"]]);export{Ve as default};
