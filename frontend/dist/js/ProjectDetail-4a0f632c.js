/* empty css                  */import{E as e,a}from"./el-col-538f99f5.js";import{E as t}from"./el-card-e67e9701.js";import{E as l,a as s}from"./el-descriptions-item-e887b571.js";import{E as i}from"./el-tag-418c1d1c.js";import{r as o,t as r,u as n,a1 as d,o as u,c,d as v,e as p,f,w as m,n as h,L as b,h as _,aE as g,j as w,q as y,E as j,l as z}from"./index-cd351671.js";import{a as S}from"./project-79976e72.js";import{d as x}from"./dayjs.min-fd58e32d.js";import{H as k}from"./index.esm.min-44700bfe.js";import{_ as L}from"./_plugin-vue_export-helper-1b428a4d.js";import{i as W}from"./install-00e2c1e8.js";import{u as C,i as E,a as q,b as G,c as O,d as R,e as Y}from"./install-1118e355.js";const D={class:"project-detail"},M={class:"info-section"},H={class:"card-header"},P={class:"header-actions"},F={class:"info-section"},I=["href"],Q={key:1},A=["href"],B={key:1},J={class:"info-section"},K={class:"card-header"},N={class:"description-count"},T={class:"description-content"},U={class:"info-section"},V={class:"stat-item-with-chart"},X={class:"stat-header"},Z={class:"stat-value"},$={class:"chart-container-small"},ee={class:"stat-item-with-chart"},ae={class:"stat-header"},te={class:"stat-value"},le={class:"chart-container-small"},se={class:"stat-item-with-chart"},ie={class:"stat-header"},oe={class:"stat-value"},re={class:"chart-container-small"},ne={class:"stat-item-with-chart"},de={class:"stat-header"},ue={class:"stat-value"},ce={class:"chart-container-small"},ve=L({__name:"ProjectDetail",setup(L){C([E,q,W,G,O,R,Y]);const ve=o(!1),pe=o({}),fe=r(),me=n(),he=o({title:{text:"",left:"center"},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"horizontal",bottom:0,left:"center",textStyle:{fontSize:10},itemGap:10,padding:[10,0,0,0]},series:[{name:"缺陷分类",type:"pie",radius:"65%",avoidLabelOverlap:!1,itemStyle:{borderRadius:0,borderColor:"#fff",borderWidth:1},label:{show:!0,position:"outside",formatter:"{b}: {c} ({d}%)",fontSize:10},emphasis:{label:{show:!0,fontSize:"12",fontWeight:"bold"}},labelLine:{show:!0},data:[]}]}),be=o({title:{text:"",left:"center"},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"horizontal",bottom:0,left:"center",textStyle:{fontSize:10},itemGap:10,padding:[10,0,0,0]},series:[{name:"用例执行情况",type:"pie",radius:"65%",avoidLabelOverlap:!1,itemStyle:{borderRadius:0,borderColor:"#fff",borderWidth:1},label:{show:!0,position:"outside",formatter:"{b}: {c} ({d}%)",fontSize:10},emphasis:{label:{show:!0,fontSize:"12",fontWeight:"bold"}},labelLine:{show:!0},data:[]}]}),_e=o({title:{text:"",left:"center"},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"horizontal",bottom:0,left:"center",textStyle:{fontSize:10},itemGap:10,padding:[10,0,0,0]},series:[{name:"迭代统计",type:"pie",radius:"65%",avoidLabelOverlap:!1,itemStyle:{borderRadius:0,borderColor:"#fff",borderWidth:1},label:{show:!0,position:"outside",formatter:"{b}: {c} ({d}%)",fontSize:10},emphasis:{label:{show:!0,fontSize:"12",fontWeight:"bold"}},labelLine:{show:!0},data:[]}]}),ge=o({title:{text:"",left:"center"},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"horizontal",bottom:0,left:"center",textStyle:{fontSize:10},itemGap:10,padding:[10,0,0,0]},series:[{name:"需求状态",type:"pie",radius:"65%",avoidLabelOverlap:!1,itemStyle:{borderRadius:0,borderColor:"#fff",borderWidth:1},label:{show:!0,position:"outside",formatter:"{b}: {c} ({d}%)",fontSize:10},emphasis:{label:{show:!0,fontSize:"12",fontWeight:"bold"}},labelLine:{show:!0},data:[]}]}),we=e=>({not_started:"未开始",in_progress:"进行中",paused:"已暂停",completed:"已完成",closed:"已关闭"}[e]||e||"-"),ye=e=>({high:"高",medium:"中",low:"低"}[e]||e),je=e=>e?x(e).format("YYYY-MM-DD HH:mm:ss"):"-",ze=()=>{const e=pe.value.bug_stats||{};he.value.series[0].data=[{value:e.high||0,name:"高优先级"},{value:e.medium||0,name:"中优先级"},{value:e.low||0,name:"低优先级"}];const a=pe.value.case_stats||{};be.value.series[0].data=[{value:a.passed||0,name:"通过"},{value:a.failed||0,name:"失败"},{value:a.blocked||0,name:"阻塞"},{value:a.not_applicable||0,name:"不适用"},{value:a.not_run||0,name:"未执行"}];const t=pe.value.iteration_stats||{},l="进行中",s="已完成",i="已取消",o=[{name:"规划中",value:t.planning||0},{name:l,value:t.active||0},{name:s,value:t.completed||0},{name:i,value:t.cancelled||0}].filter(e=>e.value>0);_e.value.series[0].data=o.length>0?o:[{name:"暂无数据",value:1}];const r=pe.value.requirement_stats||{};ge.value.series[0].data=[{value:r.new||0,name:"新建"},{value:r.in_progress||0,name:"进行中"},{value:r.completed||0,name:"已完成"},{value:r.cancelled||0,name:"已取消"}]};d(pe,()=>{ze()},{deep:!0});const Se=()=>{me.push("/projects")},xe=()=>{h.info("编辑功能待实现")};return u(()=>{(async()=>{var e;ve.value=!0;try{const a=fe.params.id,t=await S(a);pe.value=(null==(e=t.data)?void 0:e.project)||{}}catch(a){console.error("获取项目详情失败:",a),h.error("获取项目详情失败"),pe.value={}}finally{ve.value=!1,ze()}})()}),(o,r)=>{const n=j,d=z,u=i,h=l,S=s,x=t,L=a,W=e;return c(),v("div",D,[p("div",M,[f(x,{shadow:"hover",class:"info-card"},{header:m(()=>[p("div",H,[p("h2",null,"项目名称: "+b(pe.value.project_name||"未知项目"),1),p("div",P,[f(d,{type:"primary",onClick:xe},{default:m(()=>[f(n,null,{default:m(()=>[f(_(g))]),_:1}),r[0]||(r[0]=w(" 编辑 ",-1))]),_:1}),f(d,{onClick:Se},{default:m(()=>[f(n,null,{default:m(()=>[f(_(y))]),_:1}),r[1]||(r[1]=w(" 返回列表 ",-1))]),_:1})])])]),default:m(()=>[f(S,{column:2,border:""},{default:m(()=>[f(h,{label:"状态"},{default:m(()=>{return[f(u,{type:(e=pe.value.status,{not_started:"info",in_progress:"success",paused:"warning",completed:"success",closed:"danger"}[e]||"info")},{default:m(()=>[w(b(we(pe.value.status)),1)]),_:1},8,["type"])];var e}),_:1}),f(h,{label:"优先级"},{default:m(()=>{return[f(u,{type:(e=pe.value.priority,{high:"danger",medium:"warning",low:"success"}[e]||"info")},{default:m(()=>[w(b(ye(pe.value.priority)||"-"),1)]),_:1},8,["type"])];var e}),_:1}),f(h,{label:"负责人"},{default:m(()=>[w(b(pe.value.owner_name||"-"),1)]),_:1}),f(h,{label:"创建者"},{default:m(()=>[w(b(pe.value.creator_name||"-"),1)]),_:1}),f(h,{label:"开始日期"},{default:m(()=>[w(b(je(pe.value.start_date)),1)]),_:1}),f(h,{label:"结束日期"},{default:m(()=>[w(b(je(pe.value.end_date)),1)]),_:1}),f(h,{label:"创建时间"},{default:m(()=>[w(b(je(pe.value.created_at)),1)]),_:1}),f(h,{label:"更新时间"},{default:m(()=>[w(b(je(pe.value.updated_at)),1)]),_:1})]),_:1})]),_:1})]),f(W,{gutter:20,class:"info-section-row"},{default:m(()=>[f(L,{span:12},{default:m(()=>[p("div",F,[f(x,{shadow:"hover",class:"info-card equal-height-card"},{header:m(()=>[...r[2]||(r[2]=[p("div",{class:"card-header"},[p("span",null,"项目链接")],-1)])]),default:m(()=>[f(S,{column:1,border:"","label-width":"120px"},{default:m(()=>[f(h,{label:"文档链接"},{default:m(()=>[pe.value.doc_url?(c(),v("a",{key:0,href:pe.value.doc_url,target:"_blank",class:"project-link"},b(pe.value.doc_url),9,I)):(c(),v("span",Q,"-"))]),_:1}),f(h,{label:"流水线链接"},{default:m(()=>[pe.value.pipeline_url?(c(),v("a",{key:0,href:pe.value.pipeline_url,target:"_blank",class:"project-link"},b(pe.value.pipeline_url),9,A)):(c(),v("span",B,"-"))]),_:1})]),_:1})]),_:1})])]),_:1}),f(L,{span:12},{default:m(()=>[p("div",J,[f(x,{shadow:"hover",class:"info-card equal-height-card"},{header:m(()=>[p("div",K,[r[3]||(r[3]=p("span",null,"项目描述",-1)),p("span",N,b((pe.value.description||"").length)+"/"+b(100),1)])]),default:m(()=>[p("div",T,b(pe.value.description||"暂无描述"),1)]),_:1})])]),_:1})]),_:1}),p("div",U,[f(x,{shadow:"hover",class:"info-card"},{header:m(()=>[...r[4]||(r[4]=[p("div",{class:"card-header"},[p("span",null,"项目统计")],-1)])]),default:m(()=>[f(W,{gutter:20,class:"stats-overview"},{default:m(()=>[f(L,{span:6},{default:m(()=>{var e;return[p("div",V,[p("div",X,[r[5]||(r[5]=p("div",{class:"stat-label"},"缺陷总数",-1)),p("div",Z,b((null==(e=pe.value.bug_stats)?void 0:e.total)||0),1)]),p("div",$,[f(_(k),{option:he.value,autoresize:""},null,8,["option"])])])]}),_:1}),f(L,{span:6},{default:m(()=>{var e;return[p("div",ee,[p("div",ae,[r[6]||(r[6]=p("div",{class:"stat-label"},"用例总数",-1)),p("div",te,b((null==(e=pe.value.case_stats)?void 0:e.total)||0),1)]),p("div",le,[f(_(k),{option:be.value,autoresize:""},null,8,["option"])])])]}),_:1}),f(L,{span:6},{default:m(()=>[p("div",se,[p("div",ie,[r[7]||(r[7]=p("div",{class:"stat-label"},"迭代总数",-1)),p("div",oe,b(pe.value.iteration_count||0),1)]),p("div",re,[f(_(k),{option:_e.value,autoresize:""},null,8,["option"])])])]),_:1}),f(L,{span:6},{default:m(()=>[p("div",ne,[p("div",de,[r[8]||(r[8]=p("div",{class:"stat-label"},"需求总数",-1)),p("div",ue,b(pe.value.requirement_count||0),1)]),p("div",ce,[f(_(k),{option:ge.value,autoresize:""},null,8,["option"])])])]),_:1})]),_:1})]),_:1})])])}}},[["__scopeId","data-v-8e26726c"]]);export{ve as default};
