/* empty css                  */import{v as e}from"./el-loading-89207824.js";import{E as a,a as l}from"./el-descriptions-item-82fb00c5.js";import{E as t}from"./el-overlay-6e33dceb.js";import{E as s,a as o}from"./el-input-320f57dc.js";import{g as d,a as r,d as i,u as n,c as u,E as p}from"./device-e71f2550.js";import{E as c,a as m}from"./el-radio-group-e12b1858.js";import{E as f,a as _,b as v}from"./el-table-column-fbece626.js";import{E as b}from"./el-tag-611fc351.js";import{a as y,E as g}from"./el-select-9396c850.js";import"./el-scrollbar-68fecf97.js";import"./el-checkbox-b9bd0a97.js";import"./el-tooltip-4ed993c7.js";import{a as h,E as V}from"./el-col-ede98d7c.js";import{r as j,b as w,o as C,c as k,d as x,e as U,f as z,w as E,a5 as O,J as I,n as A,l as S,h as q,aB as P,j as D,aD as B,m as T,L as Y,aT as H,aW as M,i as $,aC as F,aq as K,ao as L,E as J,k as N}from"./index-ea26c5b6.js";import{d as R}from"./dayjs.min-075d2e4a.js";import{_ as W}from"./_plugin-vue_export-helper-1b428a4d.js";import"./refs-9112775b.js";import"./castArray-7303869c.js";import"./index-7696e058.js";import"./omit-2fc30497.js";import"./strings-836bc6fd.js";import"./raf-45c3df72.js";const G={class:"device-management"},Q={class:"page-header"},X={class:"header-actions"},Z={class:"stats-section"},ee={class:"stat-card"},ae={class:"stat-icon online"},le={class:"stat-content"},te={class:"stat-number"},se={class:"stat-card"},oe={class:"stat-icon offline"},de={class:"stat-content"},re={class:"stat-number"},ie={class:"stat-card"},ne={class:"stat-icon busy"},ue={class:"stat-content"},pe={class:"stat-number"},ce={class:"stat-card"},me={class:"stat-icon total"},fe={class:"stat-content"},_e={class:"stat-number"},ve={class:"search-section"},be={class:"table-section"},ye={class:"pagination"},ge={class:"dialog-footer"},he={key:0,class:"device-detail"},Ve=W({__name:"DeviceManagement",setup(W){const Ve=j(!1),je=j(!1),we=j(!1),Ce=j(!1),ke=j(!1),xe=j(""),Ue=j(),ze=j(null),Ee=w({online:0,offline:0,busy:0,total:0}),Oe=w({name:"",type:"",status:""}),Ie=w({id:null,name:"",type:"",platform:"android",os_version:"",ip_address:"",port:5555,description:""}),Ae={name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],type:[{required:!0,message:"请选择设备类型",trigger:"change"}],platform:[{required:!0,message:"请选择平台",trigger:"change"}],os_version:[{required:!0,message:"请输入系统版本",trigger:"blur"}],ip_address:[{required:!0,message:"请输入IP地址",trigger:"blur"},{pattern:/^(\d{1,3}\.){3}\d{1,3}$/,message:"请输入正确的IP地址",trigger:"blur"}],port:[{required:!0,message:"请输入端口号",trigger:"blur"}]},Se=j([]),qe=w({page:1,size:10,total:0}),Pe=async()=>{Ve.value=!0;try{const e={page:qe.page,size:qe.size,...Oe},a=await d(e);a.success?(Se.value=a.data.list,qe.total=a.data.total):A.error(a.message||"获取设备列表失败")}catch(e){console.error("获取设备列表失败:",e),A.error("获取设备列表失败")}finally{Ve.value=!1}},De=async()=>{try{const e=await r();e.success&&Object.assign(Ee,e.data)}catch(e){console.error("获取设备统计失败:",e)}},Be=()=>{qe.page=1,Pe()},Te=()=>{Object.assign(Oe,{name:"",type:"",status:""}),Be()},Ye=()=>{Pe(),De(),A.success("状态已刷新")},He=()=>{ke.value=!1,xe.value="添加设备",we.value=!0,$e()},Me=async()=>{if(Ue.value)try{let e;await Ue.value.validate(),je.value=!0,e=ke.value?await n(Ie.id,Ie):await u(Ie),e.success?(A.success(ke.value?"更新成功":"创建成功"),we.value=!1,Pe(),De()):A.error(e.message||"操作失败")}catch(e){console.error("提交失败:",e),A.error("操作失败")}finally{je.value=!1}},$e=()=>{Object.assign(Ie,{id:null,name:"",type:"",platform:"android",os_version:"",ip_address:"",port:5555,description:""}),Ue.value&&Ue.value.resetFields()},Fe=e=>{qe.size=e,qe.page=1,Pe()},Ke=e=>{qe.page=e,Pe()},Le=e=>({android_phone:"Android手机",ios_phone:"iOS手机",android_tablet:"Android平板",ios_tablet:"iOS平板"}[e]||e),Je=e=>({android_phone:"success",ios_phone:"primary",android_tablet:"warning",ios_tablet:"info"}[e]||"info"),Ne=e=>({online:"在线",offline:"离线",busy:"忙碌",maintenance:"维护"}[e]||e),Re=e=>({online:"success",offline:"danger",busy:"warning",maintenance:"info"}[e]||"info"),We=e=>e?R(e).format("YYYY-MM-DD HH:mm:ss"):"-";return C(()=>{Pe(),De()}),(d,r)=>{const n=J,u=S,j=V,w=h,C=N,R=o,W=y,$e=g,Ge=s,Qe=v,Xe=b,Ze=f,ea=_,aa=c,la=m,ta=p,sa=t,oa=a,da=l,ra=e;return k(),x("div",G,[U("div",Q,[r[15]||(r[15]=U("div",{class:"header-content"},[U("h1",null,"设备管理"),U("p",{class:"description"},"管理测试设备和设备状态")],-1)),U("div",X,[z(u,{type:"primary",onClick:He},{default:E(()=>[z(n,null,{default:E(()=>[z(q(P))]),_:1}),r[13]||(r[13]=D(" 添加设备 ",-1))]),_:1}),z(u,{onClick:Ye},{default:E(()=>[z(n,null,{default:E(()=>[z(q(B))]),_:1}),r[14]||(r[14]=D(" 刷新状态 ",-1))]),_:1})])]),U("div",Z,[z(w,{gutter:20},{default:E(()=>[z(j,{span:6},{default:E(()=>[U("div",ee,[U("div",ae,[z(n,null,{default:E(()=>[z(q(T))]),_:1})]),U("div",le,[U("div",te,Y(Ee.online),1),r[16]||(r[16]=U("div",{class:"stat-label"},"在线设备",-1))])])]),_:1}),z(j,{span:6},{default:E(()=>[U("div",se,[U("div",oe,[z(n,null,{default:E(()=>[z(q(T))]),_:1})]),U("div",de,[U("div",re,Y(Ee.offline),1),r[17]||(r[17]=U("div",{class:"stat-label"},"离线设备",-1))])])]),_:1}),z(j,{span:6},{default:E(()=>[U("div",ie,[U("div",ne,[z(n,null,{default:E(()=>[z(q(H))]),_:1})]),U("div",ue,[U("div",pe,Y(Ee.busy),1),r[18]||(r[18]=U("div",{class:"stat-label"},"忙碌设备",-1))])])]),_:1}),z(j,{span:6},{default:E(()=>[U("div",ce,[U("div",me,[z(n,null,{default:E(()=>[z(q(M))]),_:1})]),U("div",fe,[U("div",_e,Y(Ee.total),1),r[19]||(r[19]=U("div",{class:"stat-label"},"设备总数",-1))])])]),_:1})]),_:1})]),U("div",ve,[z(Ge,{model:Oe,inline:""},{default:E(()=>[z(R,{label:"设备名称"},{default:E(()=>[z(C,{modelValue:Oe.name,"onUpdate:modelValue":r[0]||(r[0]=e=>Oe.name=e),placeholder:"请输入设备名称",clearable:"",onClear:Be,onKeyup:$(Be,["enter"])},null,8,["modelValue"])]),_:1}),z(R,{label:"设备类型"},{default:E(()=>[z($e,{modelValue:Oe.type,"onUpdate:modelValue":r[1]||(r[1]=e=>Oe.type=e),placeholder:"请选择设备类型",clearable:"",onClear:Be,onChange:Be},{default:E(()=>[z(W,{label:"Android手机",value:"android_phone"}),z(W,{label:"iOS手机",value:"ios_phone"}),z(W,{label:"Android平板",value:"android_tablet"}),z(W,{label:"iOS平板",value:"ios_tablet"})]),_:1},8,["modelValue"])]),_:1}),z(R,{label:"状态"},{default:E(()=>[z($e,{modelValue:Oe.status,"onUpdate:modelValue":r[2]||(r[2]=e=>Oe.status=e),placeholder:"请选择状态",clearable:"",onClear:Be,onChange:Be},{default:E(()=>[z(W,{label:"在线",value:"online"}),z(W,{label:"离线",value:"offline"}),z(W,{label:"忙碌",value:"busy"}),z(W,{label:"维护",value:"maintenance"})]),_:1},8,["modelValue"])]),_:1}),z(R,null,{default:E(()=>[z(u,{type:"primary",onClick:Be},{default:E(()=>[z(n,null,{default:E(()=>[z(q(F))]),_:1}),r[20]||(r[20]=D(" 搜索 ",-1))]),_:1}),z(u,{onClick:Te},{default:E(()=>[z(n,null,{default:E(()=>[z(q(B))]),_:1}),r[21]||(r[21]=D(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),U("div",be,[O((k(),I(Ze,{data:Se.value,stripe:"",border:"",style:{width:"100%"}},{default:E(()=>[z(Qe,{prop:"id",label:"ID",width:"80"}),z(Qe,{prop:"name",label:"设备名称","min-width":"150"}),z(Qe,{prop:"type",label:"设备类型",width:"120"},{default:E(({row:e})=>[z(Xe,{type:Je(e.type)},{default:E(()=>[D(Y(Le(e.type)),1)]),_:2},1032,["type"])]),_:1}),z(Qe,{prop:"platform",label:"平台",width:"80"},{default:E(({row:e})=>[z(Xe,{type:"android"===e.platform?"success":"primary"},{default:E(()=>[D(Y(e.platform.toUpperCase()),1)]),_:2},1032,["type"])]),_:1}),z(Qe,{prop:"os_version",label:"系统版本",width:"100"}),z(Qe,{prop:"status",label:"状态",width:"100"},{default:E(({row:e})=>[z(Xe,{type:Re(e.status)},{default:E(()=>[D(Y(Ne(e.status)),1)]),_:2},1032,["type"])]),_:1}),z(Qe,{prop:"ip_address",label:"IP地址",width:"130"}),z(Qe,{prop:"last_seen",label:"最后在线",width:"160"},{default:E(({row:e})=>[D(Y(We(e.last_seen)),1)]),_:1}),z(Qe,{label:"操作",width:"250",fixed:"right"},{default:E(({row:e})=>[z(u,{type:"primary",size:"small",onClick:a=>(e=>{ze.value=e,Ce.value=!0})(e)},{default:E(()=>[...r[22]||(r[22]=[D(" 查看 ",-1)])]),_:1},8,["onClick"]),z(u,{type:"success",size:"small",onClick:a=>(e=>{A.success(`正在连接设备: ${e.name}`)})(e),disabled:"online"!==e.status},{default:E(()=>[...r[23]||(r[23]=[D(" 连接 ",-1)])]),_:1},8,["onClick","disabled"]),z(u,{type:"warning",size:"small",onClick:a=>(e=>{ke.value=!0,xe.value="编辑设备",we.value=!0,Object.assign(Ie,{id:e.id,name:e.name,type:e.type,platform:e.platform,os_version:e.os_version,ip_address:e.ip_address,port:e.port,description:e.description})})(e)},{default:E(()=>[...r[24]||(r[24]=[D(" 编辑 ",-1)])]),_:1},8,["onClick"]),z(u,{type:"danger",size:"small",onClick:a=>(e=>{L.confirm(`确定要删除设备 "${e.name}" 吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const a=await i(e.id);a.success?(A.success("删除成功"),Pe(),De()):A.error(a.message||"删除失败")}catch(a){console.error("删除设备失败:",a),A.error("删除失败")}})})(e)},{default:E(()=>[...r[25]||(r[25]=[D(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ra,Ve.value]]),U("div",ye,[z(ea,{"current-page":"pagination.page","page-size":"pagination.size",total:qe.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Fe,onCurrentChange:Ke},null,8,["total"])])]),z(sa,{modelValue:we.value,"onUpdate:modelValue":r[11]||(r[11]=e=>we.value=e),title:xe.value,width:"600px","close-on-click-modal":!1},{footer:E(()=>[U("span",ge,[z(u,{onClick:r[10]||(r[10]=e=>we.value=!1)},{default:E(()=>[...r[28]||(r[28]=[D("取消",-1)])]),_:1}),z(u,{type:"primary",loading:je.value,onClick:Me},{default:E(()=>[...r[29]||(r[29]=[D(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:E(()=>[z(Ge,{ref_key:"deviceFormRef",ref:Ue,model:Ie,rules:Ae,"label-width":"100px"},{default:E(()=>[z(R,{label:"设备名称",prop:"name"},{default:E(()=>[z(C,{modelValue:Ie.name,"onUpdate:modelValue":r[3]||(r[3]=e=>Ie.name=e),placeholder:"请输入设备名称"},null,8,["modelValue"])]),_:1}),z(R,{label:"设备类型",prop:"type"},{default:E(()=>[z($e,{modelValue:Ie.type,"onUpdate:modelValue":r[4]||(r[4]=e=>Ie.type=e),placeholder:"请选择设备类型"},{default:E(()=>[z(W,{label:"Android手机",value:"android_phone"}),z(W,{label:"iOS手机",value:"ios_phone"}),z(W,{label:"Android平板",value:"android_tablet"}),z(W,{label:"iOS平板",value:"ios_tablet"})]),_:1},8,["modelValue"])]),_:1}),z(R,{label:"平台",prop:"platform"},{default:E(()=>[z(la,{modelValue:Ie.platform,"onUpdate:modelValue":r[5]||(r[5]=e=>Ie.platform=e)},{default:E(()=>[z(aa,{label:"android"},{default:E(()=>[...r[26]||(r[26]=[D("Android",-1)])]),_:1}),z(aa,{label:"ios"},{default:E(()=>[...r[27]||(r[27]=[D("iOS",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),z(R,{label:"系统版本",prop:"os_version"},{default:E(()=>[z(C,{modelValue:Ie.os_version,"onUpdate:modelValue":r[6]||(r[6]=e=>Ie.os_version=e),placeholder:"请输入系统版本"},null,8,["modelValue"])]),_:1}),z(R,{label:"IP地址",prop:"ip_address"},{default:E(()=>[z(C,{modelValue:Ie.ip_address,"onUpdate:modelValue":r[7]||(r[7]=e=>Ie.ip_address=e),placeholder:"请输入IP地址"},null,8,["modelValue"])]),_:1}),z(R,{label:"端口",prop:"port"},{default:E(()=>[z(ta,{modelValue:Ie.port,"onUpdate:modelValue":r[8]||(r[8]=e=>Ie.port=e),min:1,max:65535,placeholder:"请输入端口号"},null,8,["modelValue"])]),_:1}),z(R,{label:"描述",prop:"description"},{default:E(()=>[z(C,{modelValue:Ie.description,"onUpdate:modelValue":r[9]||(r[9]=e=>Ie.description=e),type:"textarea",rows:3,placeholder:"请输入设备描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),z(sa,{modelValue:Ce.value,"onUpdate:modelValue":r[12]||(r[12]=e=>Ce.value=e),title:"设备详情",width:"800px"},{default:E(()=>[ze.value?(k(),x("div",he,[z(da,{column:2,border:""},{default:E(()=>[z(oa,{label:"设备ID"},{default:E(()=>[D(Y(ze.value.id),1)]),_:1}),z(oa,{label:"设备名称"},{default:E(()=>[D(Y(ze.value.name),1)]),_:1}),z(oa,{label:"设备类型"},{default:E(()=>[z(Xe,{type:Je(ze.value.type)},{default:E(()=>[D(Y(Le(ze.value.type)),1)]),_:1},8,["type"])]),_:1}),z(oa,{label:"平台"},{default:E(()=>[z(Xe,{type:"android"===ze.value.platform?"success":"primary"},{default:E(()=>[D(Y(ze.value.platform.toUpperCase()),1)]),_:1},8,["type"])]),_:1}),z(oa,{label:"系统版本"},{default:E(()=>[D(Y(ze.value.os_version),1)]),_:1}),z(oa,{label:"状态"},{default:E(()=>[z(Xe,{type:Re(ze.value.status)},{default:E(()=>[D(Y(Ne(ze.value.status)),1)]),_:1},8,["type"])]),_:1}),z(oa,{label:"IP地址"},{default:E(()=>[D(Y(ze.value.ip_address),1)]),_:1}),z(oa,{label:"端口"},{default:E(()=>[D(Y(ze.value.port),1)]),_:1}),z(oa,{label:"最后在线"},{default:E(()=>[D(Y(We(ze.value.last_seen)),1)]),_:1}),z(oa,{label:"创建时间"},{default:E(()=>[D(Y(We(ze.value.created_at)),1)]),_:1}),z(oa,{label:"描述",span:2},{default:E(()=>[D(Y(ze.value.description||"-"),1)]),_:1})]),_:1})])):K("",!0)]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-ef31403b"]]);export{Ve as default};
