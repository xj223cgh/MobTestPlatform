/* empty css                  */import{E as e,a as t}from"./el-descriptions-item-e887b571.js";import{E as a}from"./el-overlay-71eaae9d.js";import{a as i,E as s}from"./el-input-89ea148f.js";import{E as l}from"./el-date-picker-panel-44b3f9b1.js";import"./el-scrollbar-0528a0c4.js";import{a as r,E as o}from"./el-table-column-5340bcc8.js";import"./el-checkbox-14904d7f.js";import"./el-tooltip-4ed993c7.js";import{E as n}from"./el-tag-418c1d1c.js";import{E as d}from"./el-progress-d3d69bd1.js";import{E as c}from"./el-card-e67e9701.js";import{E as u,a as p}from"./el-tab-pane-bfdb8e67.js";import{E as m,a as v}from"./el-select-b829cea3.js";import{x as g,aF as h,y as f,G as b,aG as y,aH as _,aA as w,a4 as I,aI as x,aJ as k,aK as V,z as C,aL as j,aM as F,B as S,aN as T,aO as P,W as D,r as q,aP as R,aQ as A,a1 as $,al as z,o as E,c as L,d as O,e as B,h as U,F as M,i as Y,J as N,w as Q,K as W,E as G,aq as H,L as K,f as J,aR as X,D as Z,aS as ee,g as te,_ as ae,a9 as ie,aT as se,Y as le,M as re,an as oe,l as ne,a7 as de,ap as ce,j as ue,k as pe}from"./index-cd351671.js";import{g as me,u as ve,c as ge,a as he,d as fe,b as be,e as ye}from"./iteration-127ccd29.js";import{g as _e,b as we}from"./project-79976e72.js";import{d as Ie}from"./dayjs.min-fd58e32d.js";import{H as xe}from"./index.esm.min-44700bfe.js";import{_ as ke}from"./_plugin-vue_export-helper-1b428a4d.js";import{v as Ve,L as Ce}from"./directive-1c779a20.js";import{i as je,a as Fe}from"./install-572558c6.js";import{u as Se,i as Te,a as Pe,b as De,c as qe,d as Re,e as Ae}from"./install-1118e355.js";import{i as $e}from"./install-00e2c1e8.js";import{i as ze}from"./install-5ec4a471.js";import"./refs-9112775b.js";import"./castArray-824cd328.js";import"./index-6e95e63b.js";import"./omit-7b0b3aa9.js";import"./strings-b003b1cc.js";import"./raf-907dd12a.js";const Ee=g({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:h},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:f},activeActionIcon:{type:f},activeIcon:{type:f},inactiveIcon:{type:f},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:b(Function)},id:String,tabindex:{type:[String,Number]},...y(["ariaLabel"])}),Le={[_]:e=>w(e)||I(e)||x(e),[k]:e=>w(e)||I(e)||x(e),[V]:e=>w(e)||I(e)||x(e)},Oe="ElSwitch",Be=C({name:Oe});const Ue=re(ae(C({...Be,props:Ee,emits:Le,setup(e,{expose:t,emit:a}){const i=e,{formItem:s}=j(),l=F(),r=S("switch"),{inputId:o}=T(i,{formItemContext:s}),n=P(D(()=>i.loading)),d=q(!1!==i.modelValue),c=R(),u=D(()=>[r.b(),r.m(l.value),r.is("disabled",n.value),r.is("checked",h.value)]),p=D(()=>[r.e("label"),r.em("label","left"),r.is("active",!h.value)]),m=D(()=>[r.e("label"),r.em("label","right"),r.is("active",h.value)]),v=D(()=>({width:A(i.width)}));$(()=>i.modelValue,()=>{d.value=!0});const g=D(()=>!!d.value&&i.modelValue),h=D(()=>g.value===i.activeValue);[i.activeValue,i.inactiveValue].includes(g.value)||(a(_,i.inactiveValue),a(k,i.inactiveValue),a(V,i.inactiveValue)),$(h,e=>{var t;c.value.checked=e,i.validateEvent&&(null==(t=null==s?void 0:s.validate)||t.call(s,"change").catch(e=>z(e)))});const f=()=>{const e=h.value?i.inactiveValue:i.activeValue;a(_,e),a(k,e),a(V,e),ie(()=>{c.value.checked=h.value})},b=()=>{if(n.value)return;const{beforeChange:e}=i;if(!e)return void f();const t=e();[se(t),w(t)].includes(!0)||le(Oe,"beforeChange must return type `Promise<boolean>` or `boolean`"),se(t)?t.then(e=>{e&&f()}).catch(e=>{z(Oe,`some error occurred: ${e}`)}):t&&f()};return E(()=>{c.value.checked=h.value}),t({focus:()=>{var e,t;null==(t=null==(e=c.value)?void 0:e.focus)||t.call(e)},checked:h}),(e,t)=>(L(),O("div",{class:M(U(u)),onClick:te(b,["prevent"])},[B("input",{id:U(o),ref_key:"input",ref:c,class:M(U(r).e("input")),type:"checkbox",role:"switch","aria-checked":U(h),"aria-disabled":U(n),"aria-label":e.ariaLabel,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:U(n),tabindex:e.tabindex,onChange:f,onKeydown:Y(b,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),e.inlinePrompt||!e.inactiveIcon&&!e.inactiveText?H("v-if",!0):(L(),O("span",{key:0,class:M(U(p))},[e.inactiveIcon?(L(),N(U(G),{key:0},{default:Q(()=>[(L(),N(W(e.inactiveIcon)))]),_:1})):H("v-if",!0),!e.inactiveIcon&&e.inactiveText?(L(),O("span",{key:1,"aria-hidden":U(h)},K(e.inactiveText),9,["aria-hidden"])):H("v-if",!0)],2)),B("span",{class:M(U(r).e("core")),style:ee(U(v))},[e.inlinePrompt?(L(),O("div",{key:0,class:M(U(r).e("inner"))},[e.activeIcon||e.inactiveIcon?(L(),N(U(G),{key:0,class:M(U(r).is("icon"))},{default:Q(()=>[(L(),N(W(U(h)?e.activeIcon:e.inactiveIcon)))]),_:1},8,["class"])):e.activeText||e.inactiveText?(L(),O("span",{key:1,class:M(U(r).is("text")),"aria-hidden":!U(h)},K(U(h)?e.activeText:e.inactiveText),11,["aria-hidden"])):H("v-if",!0)],2)):H("v-if",!0),B("div",{class:M(U(r).e("action"))},[e.loading?(L(),N(U(G),{key:0,class:M(U(r).is("loading"))},{default:Q(()=>[J(U(X))]),_:1},8,["class"])):U(h)?Z(e.$slots,"active-action",{key:1},()=>[e.activeActionIcon?(L(),N(U(G),{key:0},{default:Q(()=>[(L(),N(W(e.activeActionIcon)))]),_:1})):H("v-if",!0)]):U(h)?H("v-if",!0):Z(e.$slots,"inactive-action",{key:2},()=>[e.inactiveActionIcon?(L(),N(U(G),{key:0},{default:Q(()=>[(L(),N(W(e.inactiveActionIcon)))]),_:1})):H("v-if",!0)])],2)],6),e.inlinePrompt||!e.activeIcon&&!e.activeText?H("v-if",!0):(L(),O("span",{key:1,class:M(U(m))},[e.activeIcon?(L(),N(U(G),{key:0},{default:Q(()=>[(L(),N(W(e.activeIcon)))]),_:1})):H("v-if",!0),!e.activeIcon&&e.activeText?(L(),O("span",{key:1,"aria-hidden":!U(h)},K(e.activeText),9,["aria-hidden"])):H("v-if",!0)],2))],10,["onClick"]))}}),[["__file","switch.vue"]])),Me={install(e){Ce._context=e._context,Ve._context=e._context,e.directive("loading",Ve),e.config.globalProperties.$loading=Ce},directive:Ve,service:Ce};Se([Te,Pe,$e,ze,De,qe,Re,Ae,je,Fe]);const Ye={class:"iteration-management"},Ne={class:"management-header"},Qe={class:"header-actions"},We={class:"view-tabs"},Ge={class:"gantt-container"},He={class:"search-bar"},Ke={class:"overview-cards"},Je={class:"overview-content"},Xe={class:"overview-value"},Ze={class:"overview-content"},et={class:"overview-value"},tt={class:"overview-content"},at={class:"overview-value"},it={class:"overview-content"},st={class:"overview-value"},lt={class:"kanban-container"},rt={class:"kanban-column"},ot={class:"kanban-items"},nt={class:"kanban-item-title"},dt={class:"kanban-item-meta"},ct={class:"kanban-item-date"},ut={class:"kanban-column"},pt={class:"kanban-items"},mt={class:"kanban-item-title"},vt={class:"kanban-item-progress"},gt={class:"kanban-item-meta"},ht={class:"kanban-item-date"},ft={class:"kanban-item-pass-rate"},bt={class:"kanban-column"},yt={class:"kanban-items"},_t={class:"kanban-item-title"},wt={class:"kanban-item-meta"},It={class:"kanban-item-date"},xt={class:"kanban-item-pass-rate"},kt={class:"charts-container"},Vt={class:"chart-wrapper"},Ct={class:"chart-wrapper"},jt=["onClick"],Ft={class:"pass-rate"},St={class:"bug-count"},Tt={class:"operation-buttons"},Pt={slot:"footer",class:"dialog-footer"},Dt={slot:"footer",class:"dialog-footer"},qt={key:0,class:"iteration-detail"},Rt={class:"stats-cards"},At={class:"stat-content"},$t={class:"stat-value"},zt={class:"stat-detail"},Et={class:"stat-item"},Lt={class:"stat-item"},Ot={class:"stat-item"},Bt={class:"stat-content"},Ut={class:"stat-value"},Mt={class:"stat-detail"},Yt={class:"stat-item pass"},Nt={class:"stat-item fail"},Qt={class:"stat-item blocked"},Wt={class:"stat-content"},Gt={class:"stat-value"},Ht={class:"stat-detail"},Kt={class:"stat-item critical"},Jt={class:"stat-item high"},Xt={class:"stat-item medium"},Zt={class:"stat-item low"},ea={class:"stat-status"},ta={class:"stat-item open"},aa={class:"stat-item resolved"},ia={class:"stat-item closed"},sa={slot:"footer",class:"dialog-footer"};const la=ke({name:"IterationManagement",components:{VChart:xe},data(){return{projects:[],selectedProjectId:null,activeTab:"gantt",iterations:[],iterationsData:[],total:0,currentPage:1,pageSize:10,searchQuery:"",statusFilter:"",versionRequirements:[],activeIterationsCount:0,completedIterationsCount:0,totalBugsCount:0,averagePassRate:0,plannedIterations:[],activeIterations:[],completedIterations:[],ganttChartOption:{title:{text:"迭代甘特图",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){let t=`<strong>${e[0].name}</strong><br/>`;return e.forEach(e=>{const a=Ie(e.data[0]).format("YYYY-MM-DD"),i=Ie(e.data[1]).format("YYYY-MM-DD"),s=e.data[2]||"",l=e.data[3]||0;t+=`${e.marker} <strong>${e.seriesName}</strong>: ${a} - ${i}<br/>`,s&&(t+=`状态: ${s}<br/>`),l>0&&(t+=`进度: ${l}%<br/>`)}),t}},legend:{data:["迭代","需求"],top:10,textStyle:{fontSize:12}},grid:{left:"15%",right:"10%",bottom:"15%",top:"20%",containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:"{yyyy}-{MM}-{dd}",fontSize:11},splitLine:{show:!0,lineStyle:{type:"dashed"}}},yAxis:{type:"category",data:[],axisLabel:{fontSize:12,interval:0},axisTick:{alignWithLabel:!0}},series:[{name:"迭代",type:"bar",stack:"total",itemStyle:{color:"#5470c6",borderRadius:[4,4,0,0]},data:[],barWidth:25,emphasis:{focus:"series"},label:{show:!0,position:"insideTop",formatter:"{b}",fontSize:10,color:"#fff"}},{name:"需求",type:"bar",stack:"total",itemStyle:{color:"#91cc75",borderRadius:[2,2,0,0]},data:[],barWidth:15,emphasis:{focus:"series"},label:{show:!1}}],toolbox:{feature:{saveAsImage:{pixelRatio:2},dataZoom:{yAxisIndex:"none"},restore:{}},top:10,right:10},dataZoom:[{type:"inside",xAxisIndex:0,start:0,end:100},{start:0,end:100,handleIcon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",handleSize:"80%",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}}]},progressOverviewOption:{title:{text:"",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:"{b}: {c}%"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[],axisLabel:{interval:0,rotate:45}},yAxis:{type:"value",max:100,axisLabel:{formatter:"{value}%"}},series:[{name:"进度",type:"bar",data:[],itemStyle:{color:function(e){const t=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de"];return t[e.dataIndex%t.length]},borderRadius:[4,4,0,0]},label:{show:!0,position:"top",formatter:"{c}%"}}]},iterationRequirementOption:{title:{text:"",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["总需求数","已完成需求数"],top:10},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[],axisLabel:{interval:0,rotate:45}},yAxis:{type:"value"},series:[{name:"总需求数",type:"bar",data:[],itemStyle:{color:"#5470c6"}},{name:"已完成需求数",type:"bar",data:[],itemStyle:{color:"#91cc75"}}]},bugStatsOption:{title:{text:"",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["严重","高","中","低"],top:10},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[],axisLabel:{interval:0,rotate:45}},yAxis:{type:"value"},series:[{name:"严重",type:"bar",stack:"bug",data:[],itemStyle:{color:"#ee6666"}},{name:"高",type:"bar",stack:"bug",data:[],itemStyle:{color:"#fac858"}},{name:"中",type:"bar",stack:"bug",data:[],itemStyle:{color:"#73c0de"}},{name:"低",type:"bar",stack:"bug",data:[],itemStyle:{color:"#91cc75"}}]},qualityTrendOption:{title:{text:"",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["通过率","缺陷密度"],top:10},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[],axisLabel:{interval:0,rotate:45}},yAxis:[{type:"value",name:"通过率",max:100,axisLabel:{formatter:"{value}%"}},{type:"value",name:"缺陷密度",axisLabel:{formatter:"{value}"}}],series:[{name:"通过率",type:"line",data:[],smooth:!0,itemStyle:{color:"#91cc75"},lineStyle:{width:3},symbol:"circle",symbolSize:8,label:{show:!0,position:"top",formatter:"{c}%"}},{name:"缺陷密度",type:"line",yAxisIndex:1,data:[],smooth:!0,itemStyle:{color:"#ee6666"},lineStyle:{width:3},symbol:"circle",symbolSize:8,label:{show:!0,position:"top",formatter:"{c}"}}]},iterationDialogVisible:!1,iterationDialogTitle:"创建迭代",iterationForm:{id:null,project_id:null,iteration_name:"",goal:"",version:"",start_date:"",end_date:"",status:"planning",description:""},iterationRules:{project_id:[{required:!0,message:"请选择项目",trigger:"blur"}],iteration_name:[{required:!0,message:"请输入迭代名称",trigger:"blur"},{min:2,max:50,message:"迭代名称长度在 2 到 50 个字符",trigger:"blur"}],goal:[{required:!0,message:"请输入迭代目标",trigger:"blur"},{min:5,max:200,message:"迭代目标长度在 5 到 200 个字符",trigger:"blur"}],version:[{required:!0,message:"请输入测试版本",trigger:"blur"},{min:1,max:30,message:"测试版本长度在 1 到 30 个字符",trigger:"blur"}],start_date:[{required:!0,message:"请选择开始日期",trigger:"change"}],end_date:[{required:!0,message:"请选择结束日期",trigger:"change"},{validator:(e,t,a)=>{this.iterationForm.start_date&&t<this.iterationForm.start_date?a(new Error("结束日期不能早于开始日期")):a()},trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},copyDialogVisible:!1,copyForm:{name:"",start_date:"",end_date:"",copy_test_plans:!1},copyRules:{name:[{required:!0,message:"请输入新迭代名称",trigger:"blur"}],start_date:[{required:!0,message:"请选择开始日期",trigger:"blur"}],end_date:[{required:!0,message:"请选择结束日期",trigger:"blur"}]},copiedIterationId:null,detailDialogVisible:!1,currentIteration:null,detailActiveTab:"requirements"}},mounted(){this.initProjects()},watch:{searchQuery(){this.filterIterations()},statusFilter(){this.filterIterations()}},methods:{async initProjects(){var e;try{const t=await _e();this.projects=(null==(e=t.data)?void 0:e.items)||[],console.log("Projects loaded:",this.projects),this.projects.length>0&&(this.selectedProjectId=this.projects[0].id,console.log("Selected project ID:",this.selectedProjectId),this.loadIterations(),this.loadVersionRequirements())}catch(t){console.error("获取项目列表失败:",t),this.$message.error("获取项目列表失败: "+((null==t?void 0:t.message)||"未知错误"))}},async loadIterations(){var e,t,a,i,s;if(console.log("loadIterations called"),!this.selectedProjectId)return void console.log("No project selected, returning");const l=Me.service();try{const l={page:this.currentPage,page_size:this.pageSize};console.log("Calling getProjectIterations with params:",l);const r=await me(this.selectedProjectId,l);console.log("getProjectIterations response:",r),r&&200===r.code&&r.data?(console.log("API returned",(null==(t=null==(e=r.data)?void 0:e.items)?void 0:t.length)||0,"iterations, total:",(null==(a=r.data)?void 0:a.total)||0),this.iterations=(null==(i=r.data)?void 0:i.items)||[],this.total=(null==(s=r.data)?void 0:s.total)||0,this.filterIterations(),this.updateCharts()):(console.error("Invalid API response format:",r),this.iterations=[],this.total=0,this.filterIterations(),this.updateCharts())}catch(r){console.error("Error in getProjectIterations:",r),this.$message.error("获取迭代列表失败: "+((null==r?void 0:r.message)||"未知错误")),this.iterations=[],this.total=0,this.filterIterations(),this.updateCharts()}finally{l.close()}},async loadVersionRequirements(){var e;if(this.selectedProjectId)try{const t=await we(this.selectedProjectId);this.versionRequirements=(null==(e=t.data)?void 0:e.items)||[],this.updateGanttChart()}catch(t){console.error("获取版本需求列表失败:",t),this.$message.error("获取版本需求列表失败: "+((null==t?void 0:t.message)||"未知错误")),this.versionRequirements=[]}},updateGanttChart(){if("gantt"!==this.activeTab)return;const e=Array.isArray(this.iterations)?this.iterations:[],t=Array.isArray(this.versionRequirements)?this.versionRequirements:[],a=[],i=[],s=[];e.forEach(e=>{if(e&&"object"==typeof e){s.push(e.iteration_name);const t=this.calculateRequirementProgress(e.requirement_stats);a.push({name:e.iteration_name,value:[e.start_date,e.end_date,this.getStatusText(e.status),t]})}});const l={};t.forEach(e=>{if(e&&"object"==typeof e){const t=e.iteration_name||"未分配";l[t]||(l[t]=[]),l[t].push(e)}}),e.forEach(e=>{if(e&&"object"==typeof e){(l[e.iteration_name]||[]).forEach(t=>{if(t&&"object"==typeof t){const a=this.getRequirementStatusText(t.status);i.push({name:e.iteration_name,value:[t.start_date||e.start_date,t.end_date||e.end_date,a,0]})}})}}),this.ganttChartOption.yAxis.data=s,this.ganttChartOption.series[0].data=a,this.ganttChartOption.series[1].data=i},calculateOverviewData(){const e=Array.isArray(this.iterations)?this.iterations:[];this.activeIterationsCount=e.filter(e=>"active"===(null==e?void 0:e.status)).length,this.completedIterationsCount=e.filter(e=>"completed"===(null==e?void 0:e.status)).length,this.totalBugsCount=e.reduce((e,t)=>{var a;return e+((null==(a=null==t?void 0:t.bug_stats)?void 0:a.total)||0)},0);const t=e.map(e=>e&&"object"==typeof e?this.calculatePassRate(e.execution_stats):0).filter(e=>e>0);this.averagePassRate=t.length>0?Math.round(t.reduce((e,t)=>e+t,0)/t.length):0,this.plannedIterations=e.filter(e=>"planning"===(null==e?void 0:e.status)),this.activeIterations=e.filter(e=>"active"===(null==e?void 0:e.status)),this.completedIterations=e.filter(e=>"completed"===(null==e?void 0:e.status))},updateCharts(){const e=Array.isArray(this.iterations)?this.iterations:[];this.calculateOverviewData();const t=e.map(e=>(null==e?void 0:e.iteration_name)||"").filter(Boolean),a=e.map(e=>e&&"object"==typeof e?this.calculatePassRate(e.execution_stats):0),i=e.map(e=>{var t;return e&&"object"==typeof e&&(null==(t=e.bug_stats)?void 0:t.total)||0});this.qualityTrendOption.xAxis.data=t,this.qualityTrendOption.series[0].data=a,this.qualityTrendOption.series[1].data=i;const s=e.map(e=>{var t;return e&&"object"==typeof e&&(null==(t=e.bug_stats)?void 0:t.critical)||0}),l=e.map(e=>{var t;return e&&"object"==typeof e&&(null==(t=e.bug_stats)?void 0:t.high)||0}),r=e.map(e=>{var t;return e&&"object"==typeof e&&(null==(t=e.bug_stats)?void 0:t.medium)||0}),o=e.map(e=>{var t;return e&&"object"==typeof e&&(null==(t=e.bug_stats)?void 0:t.low)||0});this.bugStatsOption.xAxis.data=t,this.bugStatsOption.series[0].data=s,this.bugStatsOption.series[1].data=l,this.bugStatsOption.series[2].data=r,this.bugStatsOption.series[3].data=o},handleTabChange(e){this.activeTab=e,setTimeout(()=>{this.loadIterations(),0===this.versionRequirements.length&&this.loadVersionRequirements()},0)},filterIterations(){console.log("filterIterations called, original iterations count:",this.iterations.length);let e=this.iterations.filter(e=>e&&"object"==typeof e);if(console.log("After filtering invalid data, count:",e.length),this.searchQuery){const t=this.searchQuery.toLowerCase();console.log("Searching with query:",t),e=e.filter(e=>{var a;return null==(a=e.iteration_name)?void 0:a.toLowerCase().includes(t)}),console.log("After name filter, count:",e.length)}this.statusFilter&&(console.log("Filtering by status:",this.statusFilter),e=e.filter(e=>e.status===this.statusFilter),console.log("After status filter, count:",e.length)),this.iterationsData=e,console.log("Final iterationsData count:",this.iterationsData.length)},handleProjectChange(){this.currentPage=1,this.loadIterations(),this.loadVersionRequirements()},handleCurrentChange(e){this.currentPage=e,this.loadIterations()},handleSizeChange(e){this.pageSize=e,this.loadIterations()},showCreateIterationDialog(){this.iterationDialogTitle="创建迭代",this.resetIterationForm(),this.iterationForm.project_id=this.selectedProjectId,this.iterationDialogVisible=!0},editIteration(e){e?(this.iterationDialogTitle="编辑迭代",this.iterationForm={...e},this.iterationDialogVisible=!0):this.$message.warning("无效的迭代数据")},resetIterationForm(){this.$refs.iterationForm&&this.$refs.iterationForm.resetFields(),this.iterationForm={id:null,project_id:this.selectedProjectId,iteration_name:"",goal:"",version:"",start_date:"",end_date:"",status:"planning",description:""}},closeIterationDialog(){this.resetIterationForm(),this.iterationDialogVisible=!1},async submitIterationForm(){this.$refs.iterationForm.validate(async e=>{if(e){if(new Date(this.iterationForm.start_date)>new Date(this.iterationForm.end_date))return void this.$message.warning("开始日期不能晚于结束日期");const e=Me.service();try{this.iterationForm.id?(await ve(this.iterationForm.id,this.iterationForm),this.$message.success("迭代更新成功")):(await ge(this.iterationForm),this.$message.success("迭代创建成功")),this.iterationDialogVisible=!1,this.loadIterations()}catch(t){this.$message.error("操作失败: "+(t.message||"未知错误"))}finally{e.close()}}})},copyIterationDialog(e){e&&e.id?(this.copiedIterationId=e.id,this.copyForm={name:`${e.iteration_name||"迭代"}_副本`,start_date:"",end_date:"",copy_test_plans:!1},this.copyDialogVisible=!0):this.$message.warning("无效的迭代数据")},async submitCopyForm(){this.$refs.copyForm.validate(async e=>{if(e){if(new Date(this.copyForm.start_date)>new Date(this.copyForm.end_date))return void this.$message.warning("开始日期不能晚于结束日期");const e=Me.service();try{await he(this.copiedIterationId,this.copyForm),this.$message.success("迭代复制成功"),this.copyDialogVisible=!1,this.loadIterations()}catch(t){this.$message.error("复制失败: "+(t.message||"未知错误"))}finally{e.close()}}})},async deleteIteration(e){e&&e.id?this.$confirm(`确定要删除迭代「${e.iteration_name||"未知迭代"}」吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const t=Me.service();try{await fe(e.id),this.$message.success("迭代删除成功"),this.loadIterations()}catch(a){this.$message.error("删除失败: "+((null==a?void 0:a.message)||"未知错误"))}finally{t.close()}}):this.$message.warning("无效的迭代数据")},async showIterationDetail(e){if(console.log("showIterationDetail called with:",e),!e||!e.id)return void this.$message.warning("无效的迭代数据");const t=Me.service();try{console.log("Calling getIteration with id:",e.id);const t=await be(e.id);console.log("getIteration response:",t),this.currentIteration=t,this.detailDialogVisible=!0,console.log("currentIteration set to:",this.currentIteration)}catch(a){console.error("Error in getIteration:",a)}finally{t.close()}},getTagTypeByStatus:e=>({planning:"info",active:"success",completed:"warning",cancelled:"danger"}[e]||"info"),getStatusText:e=>({planning:"计划中",active:"进行中",completed:"已完成",cancelled:"已取消"}[e]||e),calculateRequirementProgress:e=>e&&0!==e.total?Math.round(e.completed/e.total*100):0,calculatePassRate:e=>e&&0!==e.total?Math.round(e.pass/e.total*100):0,getProgressColor:e=>e>=90?"#67C23A":e>=60?"#E6A23C":"#F56C6C",getPassRateColor:e=>e>=95?"#67C23A":e>=80?"#E6A23C":"#F56C6C",handleDetailDialogClose(){this.detailActiveTab="requirements",this.detailDialogVisible=!1},async generateIterationReport(){if(!this.currentIteration)return;const e=Me.service();try{await ye(this.currentIteration.id);this.$message.success("迭代报告生成成功")}catch(t){console.error("生成迭代报告失败:",t),this.$message.error("生成迭代报告失败: "+((null==t?void 0:t.message)||"未知错误"))}finally{e.close()}},getRequirementStatusType:e=>({new:"info",in_progress:"success",completed:"warning",cancelled:"danger"}[e]||"info"),getRequirementStatusText:e=>({new:"未开始",in_progress:"进行中",completed:"已完成",cancelled:"已取消"}[e]||e),getTaskStatusType:e=>({pending:"info",running:"success",completed:"warning",paused:"danger"}[e]||"info"),getBugSeverityType:e=>({critical:"danger",high:"warning",medium:"info",low:"success"}[e]||"info"),getBugStatusType:e=>({open:"danger",in_progress:"warning",resolved:"info",closed:"success",reopened:"warning"}[e]||"info"),formatDate(e){if(!e)return"";return new Date(e).toLocaleString()}}},[["render",function(g,h,f,b,y,_){const w=v,I=m,x=ne,k=p,V=u,C=oe("v-chart"),j=c,F=pe,S=d,T=r,P=n,D=o,q=i,R=l,A=s,$=a,z=Ue,E=e,U=t;return L(),O("div",Ye,[B("div",Ne,[h[20]||(h[20]=B("h2",null,"迭代管理",-1)),B("div",Qe,[J(I,{modelValue:y.selectedProjectId,"onUpdate:modelValue":h[0]||(h[0]=e=>y.selectedProjectId=e),placeholder:"选择项目",style:{width:"200px","margin-right":"15px"},onChange:_.handleProjectChange},{default:Q(()=>[(L(!0),O(de,null,ce(y.projects,e=>(L(),N(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),J(x,{type:"primary",onClick:_.showCreateIterationDialog},{default:Q(()=>[...h[19]||(h[19]=[B("i",{class:"el-icon-plus"},null,-1),ue(" 创建迭代 ",-1)])]),_:1},8,["onClick"])])]),B("div",We,[J(V,{modelValue:y.activeTab,"onUpdate:modelValue":h[1]||(h[1]=e=>y.activeTab=e),onTabChange:_.handleTabChange},{default:Q(()=>[J(k,{label:"甘特图",name:"gantt"}),J(k,{label:"列表视图",name:"list"})]),_:1},8,["modelValue","onTabChange"])]),"gantt"===y.activeTab?(L(),N(j,{key:0,class:"list-card"},{default:Q(()=>[B("div",Ge,[J(C,{option:y.ganttChartOption},null,8,["option"])])]),_:1})):H("",!0),"list"===y.activeTab?(L(),N(j,{key:1,class:"list-card"},{default:Q(()=>[B("div",He,[J(F,{modelValue:y.searchQuery,"onUpdate:modelValue":h[2]||(h[2]=e=>y.searchQuery=e),placeholder:"搜索迭代名称","prefix-icon":"el-icon-search",style:{width:"300px","margin-right":"10px"}},null,8,["modelValue"]),J(I,{modelValue:y.statusFilter,"onUpdate:modelValue":h[3]||(h[3]=e=>y.statusFilter=e),placeholder:"状态筛选",style:{width:"150px","margin-right":"10px"}},{default:Q(()=>[J(w,{label:"全部状态",value:""}),J(w,{label:"计划中",value:"planning"}),J(w,{label:"进行中",value:"active"}),J(w,{label:"已完成",value:"completed"}),J(w,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"]),J(x,{type:"primary",onClick:_.loadIterations},{default:Q(()=>[...h[21]||(h[21]=[ue("查询",-1)])]),_:1},8,["onClick"])]),B("div",Ke,[J(j,{class:"overview-card"},{default:Q(()=>[B("div",Je,[h[22]||(h[22]=B("div",{class:"overview-title"},"进行中迭代",-1)),B("div",Xe,K(y.activeIterationsCount),1)])]),_:1}),J(j,{class:"overview-card"},{default:Q(()=>[B("div",Ze,[h[23]||(h[23]=B("div",{class:"overview-title"},"已完成迭代",-1)),B("div",et,K(y.completedIterationsCount),1)])]),_:1}),J(j,{class:"overview-card"},{default:Q(()=>[B("div",tt,[h[24]||(h[24]=B("div",{class:"overview-title"},"缺陷总数",-1)),B("div",at,K(y.totalBugsCount),1)])]),_:1}),J(j,{class:"overview-card"},{default:Q(()=>[B("div",it,[h[25]||(h[25]=B("div",{class:"overview-title"},"平均通过率",-1)),B("div",st,K(y.averagePassRate)+"%",1)])]),_:1})]),J(j,{class:"section-card"},{header:Q(()=>[...h[26]||(h[26]=[B("div",{class:"section-header"},[B("span",null,"迭代进度看板")],-1)])]),default:Q(()=>[B("div",lt,[B("div",rt,[h[27]||(h[27]=B("div",{class:"kanban-column-header"},"计划中",-1)),B("div",ot,[(L(!0),O(de,null,ce(y.plannedIterations,e=>(L(),O("div",{key:e.id,class:"kanban-item planning"},[B("div",nt,K(e.iteration_name),1),B("div",dt,[B("span",ct,K(e.start_date)+" - "+K(e.end_date),1)])]))),128))])]),B("div",ut,[h[28]||(h[28]=B("div",{class:"kanban-column-header"},"进行中",-1)),B("div",pt,[(L(!0),O(de,null,ce(y.activeIterations,e=>(L(),O("div",{key:e.id,class:"kanban-item active"},[B("div",mt,K(e.iteration_name),1),B("div",vt,[J(S,{percentage:_.calculateRequirementProgress(e.requirement_stats),"stroke-width":4},null,8,["percentage"])]),B("div",gt,[B("span",ht,K(e.start_date)+" - "+K(e.end_date),1),B("span",ft,"通过率: "+K(_.calculatePassRate(e.execution_stats))+"%",1)])]))),128))])]),B("div",bt,[h[29]||(h[29]=B("div",{class:"kanban-column-header"},"已完成",-1)),B("div",yt,[(L(!0),O(de,null,ce(y.completedIterations,e=>(L(),O("div",{key:e.id,class:"kanban-item completed"},[B("div",_t,K(e.iteration_name),1),B("div",wt,[B("span",It,K(e.start_date)+" - "+K(e.end_date),1),B("span",xt,"通过率: "+K(_.calculatePassRate(e.execution_stats))+"%",1)])]))),128))])])])]),_:1}),B("div",kt,[J(j,{class:"chart-card"},{header:Q(()=>[...h[30]||(h[30]=[B("div",{class:"card-header"},[B("span",null,"质量趋势")],-1)])]),default:Q(()=>[B("div",Vt,[J(C,{option:y.qualityTrendOption,autoresize:""},null,8,["option"])])]),_:1}),J(j,{class:"chart-card"},{header:Q(()=>[...h[31]||(h[31]=[B("div",{class:"card-header"},[B("span",null,"缺陷统计")],-1)])]),default:Q(()=>[B("div",Ct,[J(C,{option:y.bugStatsOption,autoresize:""},null,8,["option"])])]),_:1})]),J(j,{class:"section-card"},{header:Q(()=>[...h[32]||(h[32]=[B("div",{class:"section-header"},[B("span",null,"迭代详情")],-1)])]),default:Q(()=>[J(D,{data:y.iterationsData||[],stripe:"",style:{width:"100%","max-height":"800px","overflow-y":"auto"}},{default:Q(()=>[J(T,{prop:"iteration_name",label:"迭代名称","min-width":"180"},{default:Q(e=>{var t;return[B("a",{href:"#",onClick:te(t=>_.showIterationDetail(e.row),["stop"])},K((null==(t=e.row)?void 0:t.iteration_name)||"-"),9,jt)]}),_:1}),J(T,{label:"所属项目","min-width":"120",align:"center"},{default:Q(e=>{var t;return[ue(K((null==(t=e.row)?void 0:t.project_name)||"-"),1)]}),_:1}),J(T,{label:"状态","min-width":"100",align:"center"},{default:Q(e=>{var t;return[J(P,{type:_.getTagTypeByStatus((null==(t=e.row)?void 0:t.status)||"planning"),effect:"light"},{default:Q(()=>{var t;return[ue(K(_.getStatusText((null==(t=e.row)?void 0:t.status)||"planning")),1)]}),_:2},1032,["type"])]}),_:1}),J(T,{label:"开始日期","min-width":"120",align:"center"},{default:Q(e=>{var t;return[ue(K((null==(t=e.row)?void 0:t.start_date)||"-"),1)]}),_:1}),J(T,{label:"结束日期","min-width":"120",align:"center"},{default:Q(e=>{var t;return[ue(K((null==(t=e.row)?void 0:t.end_date)||"-"),1)]}),_:1}),J(T,{label:"需求进度","min-width":"150",align:"center"},{default:Q(e=>{var t,a;return[J(S,{percentage:_.calculateRequirementProgress(null==(t=e.row)?void 0:t.requirement_stats),"stroke-width":8,color:_.getProgressColor(_.calculateRequirementProgress(null==(a=e.row)?void 0:a.requirement_stats))},null,8,["percentage","color"])]}),_:1}),J(T,{label:"通过率","min-width":"100",align:"center"},{default:Q(e=>{var t;return[B("div",Ft,K(_.calculatePassRate(null==(t=e.row)?void 0:t.execution_stats))+"% ",1)]}),_:1}),J(T,{label:"缺陷数","min-width":"100",align:"center"},{default:Q(e=>{var t,a;return[B("div",St,K((null==(a=null==(t=e.row)?void 0:t.bug_stats)?void 0:a.total)||0),1)]}),_:1}),J(T,{label:"操作","min-width":"180",fixed:"right",align:"center"},{default:Q(e=>[B("div",Tt,[J(x,{size:"small",type:"primary",icon:"el-icon-edit",onClick:t=>_.editIteration(e.row)},{default:Q(()=>[...h[33]||(h[33]=[ue("编辑",-1)])]),_:1},8,["onClick"]),J(x,{size:"small",type:"info",icon:"el-icon-document-copy",onClick:t=>_.copyIterationDialog(e.row)},{default:Q(()=>[...h[34]||(h[34]=[ue("复制",-1)])]),_:1},8,["onClick"]),J(x,{size:"small",type:"danger",icon:"el-icon-delete",onClick:t=>_.deleteIteration(e.row)},{default:Q(()=>[...h[35]||(h[35]=[ue("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})):H("",!0),J($,{title:y.iterationDialogTitle,visible:y.iterationDialogVisible,width:"600px",onClose:_.resetIterationForm},{default:Q(()=>[J(A,{ref:"iterationForm",model:y.iterationForm,rules:y.iterationRules,"label-width":"120px"},{default:Q(()=>[J(q,{label:"项目",prop:"project_id"},{default:Q(()=>[J(I,{modelValue:y.iterationForm.project_id,"onUpdate:modelValue":h[4]||(h[4]=e=>y.iterationForm.project_id=e),placeholder:"选择项目",disabled:""},{default:Q(()=>[(L(!0),O(de,null,ce(y.projects,e=>(L(),N(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),J(q,{label:"迭代名称",prop:"iteration_name"},{default:Q(()=>[J(F,{modelValue:y.iterationForm.iteration_name,"onUpdate:modelValue":h[5]||(h[5]=e=>y.iterationForm.iteration_name=e),placeholder:"请输入迭代名称"},null,8,["modelValue"])]),_:1}),J(q,{label:"迭代目标",prop:"goal"},{default:Q(()=>[J(F,{modelValue:y.iterationForm.goal,"onUpdate:modelValue":h[6]||(h[6]=e=>y.iterationForm.goal=e),type:"textarea",placeholder:"请输入迭代目标",rows:3},null,8,["modelValue"])]),_:1}),J(q,{label:"测试版本",prop:"version"},{default:Q(()=>[J(F,{modelValue:y.iterationForm.version,"onUpdate:modelValue":h[7]||(h[7]=e=>y.iterationForm.version=e),placeholder:"请输入测试版本"},null,8,["modelValue"])]),_:1}),J(q,{label:"开始日期",prop:"start_date"},{default:Q(()=>[J(R,{modelValue:y.iterationForm.start_date,"onUpdate:modelValue":h[8]||(h[8]=e=>y.iterationForm.start_date=e),type:"date",placeholder:"选择开始日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),J(q,{label:"结束日期",prop:"end_date"},{default:Q(()=>[J(R,{modelValue:y.iterationForm.end_date,"onUpdate:modelValue":h[9]||(h[9]=e=>y.iterationForm.end_date=e),type:"date",placeholder:"选择结束日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),J(q,{label:"状态",prop:"status"},{default:Q(()=>[J(I,{modelValue:y.iterationForm.status,"onUpdate:modelValue":h[10]||(h[10]=e=>y.iterationForm.status=e),placeholder:"选择状态"},{default:Q(()=>[J(w,{label:"计划中",value:"planning"}),J(w,{label:"进行中",value:"active"}),J(w,{label:"已完成",value:"completed"}),J(w,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),J(q,{label:"备注",prop:"description"},{default:Q(()=>[J(F,{modelValue:y.iterationForm.description,"onUpdate:modelValue":h[11]||(h[11]=e=>y.iterationForm.description=e),type:"textarea",placeholder:"请输入备注信息",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),B("div",Pt,[J(x,{onClick:_.closeIterationDialog},{default:Q(()=>[...h[36]||(h[36]=[ue("取消",-1)])]),_:1},8,["onClick"]),J(x,{type:"primary",onClick:_.submitIterationForm},{default:Q(()=>[...h[37]||(h[37]=[ue("确定",-1)])]),_:1},8,["onClick"])])]),_:1},8,["title","visible","onClose"]),J($,{title:"复制迭代",visible:y.copyDialogVisible,width:"500px"},{default:Q(()=>[J(A,{ref:"copyForm",model:y.copyForm,rules:y.copyRules,"label-width":"120px"},{default:Q(()=>[J(q,{label:"新迭代名称",prop:"name"},{default:Q(()=>[J(F,{modelValue:y.copyForm.name,"onUpdate:modelValue":h[12]||(h[12]=e=>y.copyForm.name=e),placeholder:"请输入新迭代名称"},null,8,["modelValue"])]),_:1}),J(q,{label:"开始日期",prop:"start_date"},{default:Q(()=>[J(R,{modelValue:y.copyForm.start_date,"onUpdate:modelValue":h[13]||(h[13]=e=>y.copyForm.start_date=e),type:"date",placeholder:"选择开始日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),J(q,{label:"结束日期",prop:"end_date"},{default:Q(()=>[J(R,{modelValue:y.copyForm.end_date,"onUpdate:modelValue":h[14]||(h[14]=e=>y.copyForm.end_date=e),type:"date",placeholder:"选择结束日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),J(q,{label:"复制测试计划"},{default:Q(()=>[J(z,{modelValue:y.copyForm.copy_test_plans,"onUpdate:modelValue":h[15]||(h[15]=e=>y.copyForm.copy_test_plans=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),B("div",Dt,[J(x,{onClick:h[16]||(h[16]=e=>y.copyDialogVisible=!1)},{default:Q(()=>[...h[38]||(h[38]=[ue("取消",-1)])]),_:1}),J(x,{type:"primary",onClick:_.submitCopyForm},{default:Q(()=>[...h[39]||(h[39]=[ue("确定",-1)])]),_:1},8,["onClick"])])]),_:1},8,["visible"]),J($,{title:"迭代详情",visible:y.detailDialogVisible,width:"900px","before-close":_.handleDetailDialogClose},{default:Q(()=>[y.currentIteration?(L(),O("div",qt,[J(U,{border:"",column:"2","label-align":"left",class:"basic-info"},{default:Q(()=>[J(E,{label:"迭代名称"},{default:Q(()=>[ue(K(y.currentIteration.iteration_name),1)]),_:1}),J(E,{label:"所属项目"},{default:Q(()=>[ue(K(y.currentIteration.project_name),1)]),_:1}),J(E,{label:"迭代目标"},{default:Q(()=>[ue(K(y.currentIteration.goal),1)]),_:1}),J(E,{label:"测试版本"},{default:Q(()=>[ue(K(y.currentIteration.version),1)]),_:1}),J(E,{label:"状态"},{default:Q(()=>[J(P,{type:_.getTagTypeByStatus(y.currentIteration.status)},{default:Q(()=>[ue(K(_.getStatusText(y.currentIteration.status)),1)]),_:1},8,["type"])]),_:1}),J(E,{label:"开始日期"},{default:Q(()=>[ue(K(y.currentIteration.start_date),1)]),_:1}),J(E,{label:"结束日期"},{default:Q(()=>[ue(K(y.currentIteration.end_date),1)]),_:1}),J(E,{label:"创建时间"},{default:Q(()=>[ue(K(_.formatDate(y.currentIteration.created_at)),1)]),_:1}),J(E,{label:"创建人"},{default:Q(()=>[ue(K(y.currentIteration.created_by_name),1)]),_:1}),J(E,{label:"更新人"},{default:Q(()=>[ue(K(y.currentIteration.updated_by_name||"-"),1)]),_:1}),J(E,{label:"备注",span:2},{default:Q(()=>[ue(K(y.currentIteration.description||"-"),1)]),_:1})]),_:1}),B("div",Rt,[J(j,{class:"stat-card"},{default:Q(()=>{var e,t,a;return[B("div",At,[h[40]||(h[40]=B("div",{class:"stat-title"},"需求统计",-1)),B("div",$t,K(y.currentIteration.requirement_count),1),B("div",zt,[B("span",Et,"已完成: "+K((null==(e=y.currentIteration.requirement_stats)?void 0:e.completed)||0),1),B("span",Lt,"进行中: "+K((null==(t=y.currentIteration.requirement_stats)?void 0:t.in_progress)||0),1),B("span",Ot,"未开始: "+K((null==(a=y.currentIteration.requirement_stats)?void 0:a.new)||0),1)]),J(S,{percentage:_.calculateRequirementProgress(y.currentIteration.requirement_stats),"stroke-width":6,color:_.getProgressColor(_.calculateRequirementProgress(y.currentIteration.requirement_stats)),style:{"margin-top":"10px"}},null,8,["percentage","color"])])]}),_:1}),J(j,{class:"stat-card"},{default:Q(()=>{var e,t,a,i;return[B("div",Bt,[h[41]||(h[41]=B("div",{class:"stat-title"},"用例执行",-1)),B("div",Ut,K((null==(e=y.currentIteration.execution_stats)?void 0:e.total)||0),1),B("div",Mt,[B("span",Yt,"通过: "+K((null==(t=y.currentIteration.execution_stats)?void 0:t.pass)||0),1),B("span",Nt,"失败: "+K((null==(a=y.currentIteration.execution_stats)?void 0:a.fail)||0),1),B("span",Qt,"阻塞: "+K((null==(i=y.currentIteration.execution_stats)?void 0:i.blocked)||0),1)]),J(S,{percentage:_.calculatePassRate(y.currentIteration.execution_stats),"stroke-width":6,color:_.getPassRateColor(_.calculatePassRate(y.currentIteration.execution_stats)),style:{"margin-top":"10px"}},null,8,["percentage","color"])])]}),_:1}),J(j,{class:"stat-card"},{default:Q(()=>{var e,t,a,i,s,l,r,o;return[B("div",Wt,[h[42]||(h[42]=B("div",{class:"stat-title"},"缺陷统计",-1)),B("div",Gt,K(y.currentIteration.bug_count),1),B("div",Ht,[B("span",Kt,"严重: "+K((null==(e=y.currentIteration.bug_stats)?void 0:e.critical)||0),1),B("span",Jt,"高: "+K((null==(t=y.currentIteration.bug_stats)?void 0:t.high)||0),1),B("span",Xt,"中: "+K((null==(a=y.currentIteration.bug_stats)?void 0:a.medium)||0),1),B("span",Zt,"低: "+K((null==(i=y.currentIteration.bug_stats)?void 0:i.low)||0),1)]),B("div",ea,[B("span",ta,"未解决: "+K(((null==(s=y.currentIteration.bug_stats)?void 0:s.open)||0)+((null==(l=y.currentIteration.bug_stats)?void 0:l.in_progress)||0)),1),B("span",aa,"已解决: "+K((null==(r=y.currentIteration.bug_stats)?void 0:r.resolved)||0),1),B("span",ia,"已关闭: "+K((null==(o=y.currentIteration.bug_stats)?void 0:o.closed)||0),1)])])]}),_:1})]),J(V,{modelValue:y.detailActiveTab,"onUpdate:modelValue":h[17]||(h[17]=e=>y.detailActiveTab=e),class:"detail-tabs"},{default:Q(()=>[J(k,{label:"需求列表",name:"requirements"},{default:Q(()=>{var e;return[J(D,{data:(null==(e=y.currentIteration)?void 0:e.version_requirements)||[],stripe:"",style:{width:"100%"},size:"small"},{default:Q(()=>[J(T,{prop:"id",label:"ID",width:"80"}),J(T,{prop:"requirement_name",label:"需求名称"}),J(T,{prop:"status",label:"状态",width:"100"},{default:Q(e=>{var t;return[J(P,{type:_.getRequirementStatusType((null==(t=e.row)?void 0:t.status)||"new")},{default:Q(()=>{var t;return[ue(K(_.getRequirementStatusText((null==(t=e.row)?void 0:t.status)||"new")),1)]}),_:2},1032,["type"])]}),_:1}),J(T,{prop:"priority",label:"优先级",width:"100"}),J(T,{prop:"assigned_to_name",label:"负责人",width:"120"}),J(T,{prop:"start_date",label:"开始日期",width:"120"}),J(T,{prop:"end_date",label:"结束日期",width:"120"})]),_:1},8,["data"])]}),_:1}),J(k,{label:"测试任务",name:"tasks"},{default:Q(()=>{var e;return[J(D,{data:(null==(e=y.currentIteration)?void 0:e.test_tasks)||[],stripe:"",style:{width:"100%"},size:"small"},{default:Q(()=>[J(T,{prop:"id",label:"ID",width:"80"}),J(T,{prop:"task_name",label:"任务名称"}),J(T,{prop:"status",label:"状态",width:"100"},{default:Q(e=>{var t;return[J(P,{type:_.getTaskStatusType((null==(t=e.row)?void 0:t.status)||"pending")},{default:Q(()=>{var t;return[ue(K((null==(t=e.row)?void 0:t.status)||"pending"),1)]}),_:2},1032,["type"])]}),_:1}),J(T,{prop:"executor_name",label:"执行人",width:"120"}),J(T,{prop:"scheduled_time",label:"计划时间",width:"150"}),J(T,{prop:"statistics.pass_rate",label:"通过率",width:"100"})]),_:1},8,["data"])]}),_:1}),J(k,{label:"缺陷列表",name:"bugs"},{default:Q(()=>{var e;return[J(D,{data:(null==(e=y.currentIteration)?void 0:e.bugs)||[],stripe:"",style:{width:"100%"},size:"small"},{default:Q(()=>[J(T,{prop:"id",label:"ID",width:"80"}),J(T,{prop:"bug_title",label:"缺陷标题"}),J(T,{prop:"severity",label:"严重程度",width:"120"},{default:Q(e=>{var t;return[J(P,{type:_.getBugSeverityType((null==(t=e.row)?void 0:t.severity)||"medium")},{default:Q(()=>{var t;return[ue(K((null==(t=e.row)?void 0:t.severity)||"medium"),1)]}),_:2},1032,["type"])]}),_:1}),J(T,{prop:"status",label:"状态",width:"100"},{default:Q(e=>{var t;return[J(P,{type:_.getBugStatusType((null==(t=e.row)?void 0:t.status)||"open")},{default:Q(()=>{var t;return[ue(K((null==(t=e.row)?void 0:t.status)||"open"),1)]}),_:2},1032,["type"])]}),_:1}),J(T,{prop:"reporter_name",label:"报告人",width:"120"}),J(T,{prop:"created_at",label:"创建时间",width:"150"})]),_:1},8,["data"])]}),_:1})]),_:1},8,["modelValue"])])):H("",!0),B("div",sa,[J(x,{onClick:h[18]||(h[18]=e=>y.detailDialogVisible=!1)},{default:Q(()=>[...h[43]||(h[43]=[ue("关闭",-1)])]),_:1}),J(x,{type:"primary",onClick:_.generateIterationReport},{default:Q(()=>[...h[44]||(h[44]=[ue("生成报告",-1)])]),_:1},8,["onClick"])])]),_:1},8,["visible","before-close"])])}],["__scopeId","data-v-bd651026"]]);export{la as default};
