/* empty css                  */import{E as s,a as e}from"./el-input-89ea148f.js";import{E as a}from"./el-link-c245de26.js";import{u as r,t as o,r as l,b as t,o as d,n,c as i,d as u,e as p,f as c,w as m,g as w,i as f,j as v,h as g,q as _,v as h,k as y,l as k,E as b}from"./index-cd351671.js";import{_ as E}from"./_plugin-vue_export-helper-1b428a4d.js";import"./castArray-824cd328.js";const P={class:"reset-password-container"},j={class:"reset-password-card"},x={class:"back-link"},V=E({__name:"ResetPassword",setup(E){const V=r(),q=o(),z=l(null),A=l(!1),C=t({password:"",confirmPassword:""}),F=l(""),L=l(""),R={password:[{validator:(s,e,a)=>{var r;""===e?a(new Error("请输入新密码")):e.length<6?a(new Error("密码长度不能少于 6 个字符")):/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(e)?(""!==C.confirmPassword&&(null==(r=z.value)||r.validateField("confirmPassword")),a()):a(new Error("密码必须包含大小写字母和数字"))},trigger:"blur"}],confirmPassword:[{validator:(s,e,a)=>{""===e?a(new Error("请再次输入密码")):e!==C.password?a(new Error("两次输入密码不一致")):a()},trigger:"blur"}]},T=async()=>{var s,e;if(z.value)try{await z.value.validate(),A.value=!0;const s=await h({email:F.value,token:L.value,password:C.password});s.success?(n.success("密码重置成功，请登录"),setTimeout(()=>{V.push("/login")},1500)):n.error(s.message||"重置失败")}catch(a){console.error("重置密码失败:",a),n.error((null==(e=null==(s=a.response)?void 0:s.data)?void 0:e.message)||"重置失败")}finally{A.value=!1}},U=()=>{V.push("/login")};return d(()=>{F.value=q.query.email||"",L.value=q.query.token||"",F.value&&L.value||(n.error("重置链接无效，请重新申请"),V.push("/forgot-password"))}),(r,o)=>{const l=y,t=e,d=k,n=b,h=a,E=s;return i(),u("div",P,[p("div",j,[o[4]||(o[4]=p("div",{class:"reset-password-header"},[p("div",{class:"logo-text"},"MobTest"),p("h1",null,"重置密码"),p("p",null,"请设置您的新密码")],-1)),c(E,{ref_key:"resetFormRef",ref:z,model:C,rules:R,class:"reset-password-form",onSubmit:w(T,["prevent"])},{default:m(()=>[c(t,{prop:"password"},{default:m(()=>[c(l,{modelValue:C.password,"onUpdate:modelValue":o[0]||(o[0]=s=>C.password=s),type:"password",placeholder:"请输入新密码",size:"large","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),c(t,{prop:"confirmPassword"},{default:m(()=>[c(l,{modelValue:C.confirmPassword,"onUpdate:modelValue":o[1]||(o[1]=s=>C.confirmPassword=s),type:"password",placeholder:"请确认新密码",size:"large","prefix-icon":"Lock","show-password":"",clearable:"",onKeyup:f(T,["enter"])},null,8,["modelValue"])]),_:1}),c(t,null,{default:m(()=>[c(d,{type:"primary",size:"large",loading:A.value,class:"reset-btn",onClick:T},{default:m(()=>[...o[2]||(o[2]=[v(" 重置密码 ",-1)])]),_:1},8,["loading"])]),_:1}),p("div",x,[c(h,{type:"primary",onClick:U},{default:m(()=>[c(n,null,{default:m(()=>[c(g(_))]),_:1}),o[3]||(o[3]=v(" 返回登录 ",-1))]),_:1})])]),_:1},8,["model"])]),o[5]||(o[5]=p("div",{class:"reset-password-footer"},[p("p",null,"© 2024 移动端测试平台. All rights reserved.")],-1))])}}},[["__scopeId","data-v-4974f6df"]]);export{V as default};
