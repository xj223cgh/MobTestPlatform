/* empty css                  *//* empty css                   */import{E as e,a}from"./el-descriptions-item-e887b571.js";import{E as l}from"./el-overlay-71eaae9d.js";import{E as t,a as s}from"./el-radio-group-56c94ad0.js";import{E as o}from"./el-pagination-aa6134da.js";import{E as d}from"./el-tag-418c1d1c.js";import{a as r,E as u}from"./el-select-b829cea3.js";import"./el-scrollbar-0528a0c4.js";import{E as i,a as n}from"./el-input-89ea148f.js";import{E as p,a as c}from"./el-table-column-5340bcc8.js";import"./el-checkbox-14904d7f.js";import"./el-tooltip-4ed993c7.js";import{E as m,a as f}from"./el-col-538f99f5.js";import{E as v,a as _}from"./el-tab-pane-bfdb8e67.js";import{r as b,b as g,o as y,c as h,d as w,e as V,f as C,w as k,a5 as j,J as x,L as U,aq as z,n as E,ao as Y,l as D,h as B,aB as O,j as $,aX as L,aY as T,aZ as q,a_ as M,a$ as R,b0 as H,i as I,aC as F,aD as S,E as A,k as J}from"./index-cd351671.js";import{g as K,a as N,e as Q,b as X,d as Z,u as G,c as P}from"./testCase-4120f24e.js";import{d as W}from"./dayjs.min-fd58e32d.js";import{_ as ee}from"./_plugin-vue_export-helper-1b428a4d.js";import{v as ae}from"./directive-1c779a20.js";import"./refs-9112775b.js";import"./omit-7b0b3aa9.js";import"./strings-b003b1cc.js";import"./castArray-824cd328.js";import"./raf-907dd12a.js";const le={class:"test-case-management"},te={class:"page-header"},se={class:"header-tabs"},oe={class:"header-actions"},de={class:"stats-section"},re={class:"stat-card"},ue={class:"stat-icon total"},ie={class:"stat-content"},ne={class:"stat-number"},pe={class:"stat-card"},ce={class:"stat-icon passed"},me={class:"stat-content"},fe={class:"stat-number"},ve={class:"stat-card"},_e={class:"stat-icon failed"},be={class:"stat-content"},ge={class:"stat-number"},ye={class:"stat-card"},he={class:"stat-icon pending"},we={class:"stat-content"},Ve={class:"stat-number"},Ce={class:"search-section"},ke={class:"table-section"},je={key:0,class:"batch-actions"},xe={class:"pagination"},Ue={class:"dialog-footer"},ze={key:0,class:"test-case-detail"},Ee={class:"steps-content"},Ye=ee({__name:"TestCaseManagement",setup(ee){const Ye=b(!1),De=b(!1),Be=b(!1),Oe=b(!1),$e=b(!1),Le=b(""),Te=b(),qe=b(null),Me=b([]),Re=b("list"),He=g({total:0,passed:0,failed:0,pending:0}),Ie=g({name:"",module:"",priority:"",status:""}),Fe=g({id:null,name:"",module:"",priority:"medium",preconditions:"",steps:"",expected_result:"",remarks:""}),Se={name:[{required:!0,message:"请输入用例名称",trigger:"blur"}],module:[{required:!0,message:"请选择模块",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}],steps:[{required:!0,message:"请输入测试步骤",trigger:"blur"}]},Ae=b([]),Je=g({page:1,size:10,total:0}),Ke=async()=>{Ye.value=!0;try{const e={page:Je.page,size:Je.size,...Ie},a=await K(e);a.success?(Ae.value=a.data.list,Je.total=a.data.total):E.error(a.message||"获取测试用例列表失败")}catch(e){console.error("获取测试用例列表失败:",e),E.error("获取测试用例列表失败")}finally{Ye.value=!1}},Ne=async()=>{try{const e=await N();e.success&&Object.assign(He,e.data)}catch(e){console.error("获取测试用例统计失败:",e)}},Qe=()=>{Je.page=1,Ke()},Xe=()=>{Object.assign(Ie,{name:"",module:"",priority:"",status:""}),Qe()},Ze=()=>{$e.value=!1,Le.value="新建测试用例",Be.value=!0,ta()},Ge=()=>{E.info("导入功能开发中...")},Pe=async()=>{try{const e=await Q(Ie),a=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(a),t=document.createElement("a");t.href=l,t.download=`test_cases_${W().format("YYYY-MM-DD_HH-mm-ss")}.xlsx`,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(l),E.success("导出成功")}catch(e){console.error("导出失败:",e),E.error("导出失败")}},We=e=>{Me.value=e},ea=()=>{0!==Me.value.length?E.success(`正在批量执行 ${Me.value.length} 个测试用例`):E.warning("请选择要执行的测试用例")},aa=()=>{0!==Me.value.length?Y.confirm(`确定要删除选中的 ${Me.value.length} 个测试用例吗？此操作不可恢复。`,"确认批量删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=Me.value.map(e=>e.id),a=await X(e);a.success?(E.success("批量删除成功"),Ke(),Ne()):E.error(a.message||"批量删除失败")}catch(e){console.error("批量删除失败:",e),E.error("批量删除失败")}}):E.warning("请选择要删除的测试用例")},la=async()=>{if(Te.value)try{let e;await Te.value.validate(),De.value=!0,e=$e.value?await G(Fe.id,Fe):await P(Fe),e.success?(E.success($e.value?"更新成功":"创建成功"),Be.value=!1,Ke(),Ne()):E.error(e.message||"操作失败")}catch(e){console.error("提交失败:",e),E.error("操作失败")}finally{De.value=!1}},ta=()=>{Object.assign(Fe,{id:null,name:"",module:"",priority:"medium",preconditions:"",steps:"",expected_result:"",remarks:""}),Te.value&&Te.value.resetFields()},sa=e=>{Je.size=e,Je.page=1,Ke()},oa=e=>{Je.page=e,Ke()},da=e=>({login:"登录模块",user:"用户管理",device:"设备管理",test:"测试管理"}[e]||e),ra=e=>({login:"primary",user:"success",device:"warning",test:"info"}[e]||"info"),ua=e=>({high:"高",medium:"中",low:"低"}[e]||e),ia=e=>({high:"danger",medium:"warning",low:"success"}[e]||"info"),na=e=>({passed:"通过",failed:"失败",pending:"待执行",not_applicable:"不适用"}[e]||e),pa=e=>({passed:"success",failed:"danger",pending:"warning",not_applicable:"info"}[e]||"info"),ca=e=>e?W(e).format("YYYY-MM-DD HH:mm:ss"):"-",ma=e=>{"reviews"===e.paneName&&(window.location.href="/test-cases/case-reviews")};return y(()=>{Ke(),Ne()}),(b,g)=>{const y=_,K=v,N=A,Q=D,X=f,G=m,P=J,W=n,ee=r,ta=u,fa=i,va=c,_a=d,ba=p,ga=o,ya=t,ha=s,wa=l,Va=e,Ca=a,ka=ae;return h(),w("div",le,[V("div",te,[g[18]||(g[18]=V("div",{class:"header-content"},[V("h1",null,"测试用例管理"),V("p",{class:"description"},"管理和执行测试用例")],-1)),V("div",se,[C(K,{modelValue:Re.value,"onUpdate:modelValue":g[0]||(g[0]=e=>Re.value=e),onTabClick:ma},{default:k(()=>[C(y,{label:"用例列表",name:"list"}),C(y,{label:"用例评审",name:"reviews"})]),_:1},8,["modelValue"])]),V("div",oe,[C(Q,{type:"primary",onClick:Ze},{default:k(()=>[C(N,null,{default:k(()=>[C(B(O))]),_:1}),g[15]||(g[15]=$(" 新建用例 ",-1))]),_:1}),C(Q,{onClick:Ge},{default:k(()=>[C(N,null,{default:k(()=>[C(B(L))]),_:1}),g[16]||(g[16]=$(" 导入用例 ",-1))]),_:1}),C(Q,{onClick:Pe},{default:k(()=>[C(N,null,{default:k(()=>[C(B(T))]),_:1}),g[17]||(g[17]=$(" 导出用例 ",-1))]),_:1})])]),V("div",de,[C(G,{gutter:20},{default:k(()=>[C(X,{span:6},{default:k(()=>[V("div",re,[V("div",ue,[C(N,null,{default:k(()=>[C(B(q))]),_:1})]),V("div",ie,[V("div",ne,U(He.total),1),g[19]||(g[19]=V("div",{class:"stat-label"},"用例总数",-1))])])]),_:1}),C(X,{span:6},{default:k(()=>[V("div",pe,[V("div",ce,[C(N,null,{default:k(()=>[C(B(M))]),_:1})]),V("div",me,[V("div",fe,U(He.passed),1),g[20]||(g[20]=V("div",{class:"stat-label"},"通过用例",-1))])])]),_:1}),C(X,{span:6},{default:k(()=>[V("div",ve,[V("div",_e,[C(N,null,{default:k(()=>[C(B(R))]),_:1})]),V("div",be,[V("div",ge,U(He.failed),1),g[21]||(g[21]=V("div",{class:"stat-label"},"失败用例",-1))])])]),_:1}),C(X,{span:6},{default:k(()=>[V("div",ye,[V("div",he,[C(N,null,{default:k(()=>[C(B(H))]),_:1})]),V("div",we,[V("div",Ve,U(He.pending),1),g[22]||(g[22]=V("div",{class:"stat-label"},"待执行用例",-1))])])]),_:1})]),_:1})]),V("div",Ce,[C(fa,{model:Ie,inline:""},{default:k(()=>[C(W,{label:"用例名称"},{default:k(()=>[C(P,{modelValue:Ie.name,"onUpdate:modelValue":g[1]||(g[1]=e=>Ie.name=e),placeholder:"请输入用例名称",clearable:"",onClear:Qe,onKeyup:I(Qe,["enter"])},null,8,["modelValue"])]),_:1}),C(W,{label:"模块"},{default:k(()=>[C(ta,{modelValue:Ie.module,"onUpdate:modelValue":g[2]||(g[2]=e=>Ie.module=e),placeholder:"请选择模块",clearable:"",onClear:Qe,onChange:Qe},{default:k(()=>[C(ee,{label:"登录模块",value:"login"}),C(ee,{label:"用户管理",value:"user"}),C(ee,{label:"设备管理",value:"device"}),C(ee,{label:"测试管理",value:"test"})]),_:1},8,["modelValue"])]),_:1}),C(W,{label:"优先级"},{default:k(()=>[C(ta,{modelValue:Ie.priority,"onUpdate:modelValue":g[3]||(g[3]=e=>Ie.priority=e),placeholder:"请选择优先级",clearable:"",onClear:Qe,onChange:Qe},{default:k(()=>[C(ee,{label:"高",value:"high"}),C(ee,{label:"中",value:"medium"}),C(ee,{label:"低",value:"low"})]),_:1},8,["modelValue"])]),_:1}),C(W,{label:"状态"},{default:k(()=>[C(ta,{modelValue:Ie.status,"onUpdate:modelValue":g[4]||(g[4]=e=>Ie.status=e),placeholder:"请选择状态",clearable:"",onClear:Qe,onChange:Qe},{default:k(()=>[C(ee,{label:"通过",value:"passed"}),C(ee,{label:"失败",value:"failed"}),C(ee,{label:"待执行",value:"pending"}),C(ee,{label:"跳过",value:"skipped"})]),_:1},8,["modelValue"])]),_:1}),C(W,null,{default:k(()=>[C(Q,{type:"primary",onClick:Qe},{default:k(()=>[C(N,null,{default:k(()=>[C(B(F))]),_:1}),g[23]||(g[23]=$(" 搜索 ",-1))]),_:1}),C(Q,{onClick:Xe},{default:k(()=>[C(N,null,{default:k(()=>[C(B(S))]),_:1}),g[24]||(g[24]=$(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),V("div",ke,[j((h(),x(ba,{data:Ae.value,stripe:"",border:"",style:{width:"100%"},onSelectionChange:We},{default:k(()=>[C(va,{type:"selection",width:"55"}),C(va,{prop:"id",label:"ID",width:"80"}),C(va,{prop:"name",label:"用例名称","min-width":"200","show-overflow-tooltip":""}),C(va,{prop:"module",label:"模块",width:"100"},{default:k(({row:e})=>[C(_a,{type:ra(e.module)},{default:k(()=>[$(U(da(e.module)),1)]),_:2},1032,["type"])]),_:1}),C(va,{prop:"priority",label:"优先级",width:"80"},{default:k(({row:e})=>[C(_a,{type:ia(e.priority)},{default:k(()=>[$(U(ua(e.priority)),1)]),_:2},1032,["type"])]),_:1}),C(va,{prop:"status",label:"状态",width:"80"},{default:k(({row:e})=>[C(_a,{type:pa(e.status)},{default:k(()=>[$(U(na(e.status)),1)]),_:2},1032,["type"])]),_:1}),C(va,{prop:"creator",label:"创建者",width:"100"}),C(va,{prop:"created_at",label:"创建时间",width:"160"},{default:k(({row:e})=>[$(U(ca(e.created_at)),1)]),_:1}),C(va,{prop:"updated_at",label:"更新时间",width:"160"},{default:k(({row:e})=>[$(U(ca(e.updated_at)),1)]),_:1}),C(va,{label:"操作",width:"250",fixed:"right"},{default:k(({row:e})=>[C(Q,{type:"primary",size:"small",onClick:a=>(e=>{qe.value=e,Oe.value=!0})(e)},{default:k(()=>[...g[25]||(g[25]=[$(" 查看 ",-1)])]),_:1},8,["onClick"]),C(Q,{type:"success",size:"small",onClick:a=>(e=>{E.success(`正在执行测试用例: ${e.name}`)})(e)},{default:k(()=>[...g[26]||(g[26]=[$(" 执行 ",-1)])]),_:1},8,["onClick"]),C(Q,{type:"warning",size:"small",onClick:a=>(e=>{$e.value=!0,Le.value="编辑测试用例",Be.value=!0,Object.assign(Fe,{id:e.id,name:e.name,module:e.module,priority:e.priority,preconditions:e.preconditions,steps:e.steps,expected_result:e.expected_result,remarks:e.remarks})})(e)},{default:k(()=>[...g[27]||(g[27]=[$(" 编辑 ",-1)])]),_:1},8,["onClick"]),C(Q,{type:"danger",size:"small",onClick:a=>(e=>{Y.confirm(`确定要删除测试用例 "${e.name}" 吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const a=await Z(e.id);a.success?(E.success("删除成功"),Ke(),Ne()):E.error(a.message||"删除失败")}catch(a){console.error("删除测试用例失败:",a),E.error("删除失败")}})})(e)},{default:k(()=>[...g[28]||(g[28]=[$(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ka,Ye.value]]),Me.value.length>0?(h(),w("div",je,[V("span",null,"已选择 "+U(Me.value.length)+" 项",1),C(Q,{type:"success",onClick:ea},{default:k(()=>[...g[29]||(g[29]=[$(" 批量执行 ",-1)])]),_:1}),C(Q,{type:"danger",onClick:aa},{default:k(()=>[...g[30]||(g[30]=[$(" 批量删除 ",-1)])]),_:1})])):z("",!0),V("div",xe,[C(ga,{"current-page":"pagination.page","page-size":"pagination.size",total:Je.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:sa,onCurrentChange:oa},null,8,["total"])])]),C(wa,{modelValue:Be.value,"onUpdate:modelValue":g[13]||(g[13]=e=>Be.value=e),title:Le.value,width:"800px","close-on-click-modal":!1},{footer:k(()=>[V("span",Ue,[C(Q,{onClick:g[12]||(g[12]=e=>Be.value=!1)},{default:k(()=>[...g[34]||(g[34]=[$("取消",-1)])]),_:1}),C(Q,{type:"primary",loading:De.value,onClick:la},{default:k(()=>[...g[35]||(g[35]=[$(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:k(()=>[C(fa,{ref_key:"testCaseFormRef",ref:Te,model:Fe,rules:Se,"label-width":"100px"},{default:k(()=>[C(W,{label:"用例名称",prop:"name"},{default:k(()=>[C(P,{modelValue:Fe.name,"onUpdate:modelValue":g[5]||(g[5]=e=>Fe.name=e),placeholder:"请输入用例名称"},null,8,["modelValue"])]),_:1}),C(W,{label:"所属模块",prop:"module"},{default:k(()=>[C(ta,{modelValue:Fe.module,"onUpdate:modelValue":g[6]||(g[6]=e=>Fe.module=e),placeholder:"请选择模块"},{default:k(()=>[C(ee,{label:"登录模块",value:"login"}),C(ee,{label:"用户管理",value:"user"}),C(ee,{label:"设备管理",value:"device"}),C(ee,{label:"测试管理",value:"test"})]),_:1},8,["modelValue"])]),_:1}),C(W,{label:"优先级",prop:"priority"},{default:k(()=>[C(ha,{modelValue:Fe.priority,"onUpdate:modelValue":g[7]||(g[7]=e=>Fe.priority=e)},{default:k(()=>[C(ya,{label:"high"},{default:k(()=>[...g[31]||(g[31]=[$("高",-1)])]),_:1}),C(ya,{label:"medium"},{default:k(()=>[...g[32]||(g[32]=[$("中",-1)])]),_:1}),C(ya,{label:"low"},{default:k(()=>[...g[33]||(g[33]=[$("低",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),C(W,{label:"前置条件",prop:"preconditions"},{default:k(()=>[C(P,{modelValue:Fe.preconditions,"onUpdate:modelValue":g[8]||(g[8]=e=>Fe.preconditions=e),type:"textarea",rows:3,placeholder:"请输入前置条件"},null,8,["modelValue"])]),_:1}),C(W,{label:"测试步骤",prop:"steps"},{default:k(()=>[C(P,{modelValue:Fe.steps,"onUpdate:modelValue":g[9]||(g[9]=e=>Fe.steps=e),type:"textarea",rows:5,placeholder:"请输入测试步骤，每行一个步骤"},null,8,["modelValue"])]),_:1}),C(W,{label:"预期结果",prop:"expected_result"},{default:k(()=>[C(P,{modelValue:Fe.expected_result,"onUpdate:modelValue":g[10]||(g[10]=e=>Fe.expected_result=e),type:"textarea",rows:3,placeholder:"请输入预期结果"},null,8,["modelValue"])]),_:1}),C(W,{label:"备注",prop:"remarks"},{default:k(()=>[C(P,{modelValue:Fe.remarks,"onUpdate:modelValue":g[11]||(g[11]=e=>Fe.remarks=e),type:"textarea",rows:2,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),C(wa,{modelValue:Oe.value,"onUpdate:modelValue":g[14]||(g[14]=e=>Oe.value=e),title:"测试用例详情",width:"800px"},{default:k(()=>[qe.value?(h(),w("div",ze,[C(Ca,{column:2,border:""},{default:k(()=>[C(Va,{label:"用例ID"},{default:k(()=>[$(U(qe.value.id),1)]),_:1}),C(Va,{label:"用例名称"},{default:k(()=>[$(U(qe.value.name),1)]),_:1}),C(Va,{label:"所属模块"},{default:k(()=>[C(_a,{type:ra(qe.value.module)},{default:k(()=>[$(U(da(qe.value.module)),1)]),_:1},8,["type"])]),_:1}),C(Va,{label:"优先级"},{default:k(()=>[C(_a,{type:ia(qe.value.priority)},{default:k(()=>[$(U(ua(qe.value.priority)),1)]),_:1},8,["type"])]),_:1}),C(Va,{label:"状态"},{default:k(()=>[C(_a,{type:pa(qe.value.status)},{default:k(()=>[$(U(na(qe.value.status)),1)]),_:1},8,["type"])]),_:1}),C(Va,{label:"创建者"},{default:k(()=>[$(U(qe.value.creator),1)]),_:1}),C(Va,{label:"创建时间"},{default:k(()=>[$(U(ca(qe.value.created_at)),1)]),_:1}),C(Va,{label:"更新时间"},{default:k(()=>[$(U(ca(qe.value.updated_at)),1)]),_:1}),C(Va,{label:"前置条件",span:2},{default:k(()=>[$(U(qe.value.preconditions||"-"),1)]),_:1}),C(Va,{label:"测试步骤",span:2},{default:k(()=>[V("div",Ee,U(qe.value.steps),1)]),_:1}),C(Va,{label:"预期结果",span:2},{default:k(()=>[$(U(qe.value.expected_result||"-"),1)]),_:1}),C(Va,{label:"备注",span:2},{default:k(()=>[$(U(qe.value.remarks||"-"),1)]),_:1})]),_:1})])):z("",!0)]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-895edb9a"]]);export{Ye as default};
