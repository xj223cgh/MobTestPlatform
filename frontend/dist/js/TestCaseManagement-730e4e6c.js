/* empty css                  */import{v as e}from"./el-loading-89207824.js";import{E as a,a as l}from"./el-descriptions-item-82fb00c5.js";import{E as t}from"./el-overlay-6e33dceb.js";import{E as s,a as o}from"./el-radio-group-e12b1858.js";import{E as d,a as r,b as u}from"./el-table-column-fbece626.js";import{E as i}from"./el-tag-611fc351.js";import{a as n,E as c}from"./el-select-9396c850.js";import"./el-scrollbar-68fecf97.js";import{E as p,a as m}from"./el-input-320f57dc.js";import"./el-checkbox-b9bd0a97.js";import"./el-tooltip-4ed993c7.js";import{a as f,E as v}from"./el-col-ede98d7c.js";import{E as _,a as b}from"./el-tab-pane-af682d02.js";import{r as g,b as y,o as h,c as w,d as V,e as C,f as k,w as j,a5 as x,J as U,L as z,aq as E,n as Y,ao as B,l as D,h as q,aB as L,j as O,aX as T,aY as $,aZ as H,a_ as M,a$ as R,b0 as I,i as A,aC as F,aD as K,E as N,k as S}from"./index-ea26c5b6.js";import{g as J,a as P,e as W,b as X,d as Z,u as G,c as Q}from"./testCase-8d3d0bad.js";import{d as ee}from"./dayjs.min-075d2e4a.js";import{_ as ae}from"./_plugin-vue_export-helper-1b428a4d.js";import"./refs-9112775b.js";import"./omit-2fc30497.js";import"./castArray-7303869c.js";import"./strings-836bc6fd.js";import"./raf-45c3df72.js";const le={class:"test-case-management"},te={class:"page-header"},se={class:"header-tabs"},oe={class:"header-actions"},de={class:"stats-section"},re={class:"stat-card"},ue={class:"stat-icon total"},ie={class:"stat-content"},ne={class:"stat-number"},ce={class:"stat-card"},pe={class:"stat-icon passed"},me={class:"stat-content"},fe={class:"stat-number"},ve={class:"stat-card"},_e={class:"stat-icon failed"},be={class:"stat-content"},ge={class:"stat-number"},ye={class:"stat-card"},he={class:"stat-icon pending"},we={class:"stat-content"},Ve={class:"stat-number"},Ce={class:"search-section"},ke={class:"table-section"},je={key:0,class:"batch-actions"},xe={class:"pagination"},Ue={class:"dialog-footer"},ze={key:0,class:"test-case-detail"},Ee={class:"steps-content"},Ye=ae({__name:"TestCaseManagement",setup(ae){const Ye=g(!1),Be=g(!1),De=g(!1),qe=g(!1),Le=g(!1),Oe=g(""),Te=g(),$e=g(null),He=g([]),Me=g("list"),Re=y({total:0,passed:0,failed:0,pending:0}),Ie=y({name:"",module:"",priority:"",status:""}),Ae=y({id:null,name:"",module:"",priority:"medium",preconditions:"",steps:"",expected_result:"",remarks:""}),Fe={name:[{required:!0,message:"请输入用例名称",trigger:"blur"}],module:[{required:!0,message:"请选择模块",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}],steps:[{required:!0,message:"请输入测试步骤",trigger:"blur"}]},Ke=g([]),Ne=y({page:1,size:10,total:0}),Se=async()=>{Ye.value=!0;try{const e={page:Ne.page,size:Ne.size,...Ie},a=await J(e);a.success?(Ke.value=a.data.list,Ne.total=a.data.total):Y.error(a.message||"获取测试用例列表失败")}catch(e){console.error("获取测试用例列表失败:",e),Y.error("获取测试用例列表失败")}finally{Ye.value=!1}},Je=async()=>{try{const e=await P();e.success&&Object.assign(Re,e.data)}catch(e){console.error("获取测试用例统计失败:",e)}},Pe=()=>{Ne.page=1,Se()},We=()=>{Object.assign(Ie,{name:"",module:"",priority:"",status:""}),Pe()},Xe=()=>{Le.value=!1,Oe.value="新建测试用例",De.value=!0,ta()},Ze=()=>{Y.info("导入功能开发中...")},Ge=async()=>{try{const e=await W(Ie),a=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(a),t=document.createElement("a");t.href=l,t.download=`test_cases_${ee().format("YYYY-MM-DD_HH-mm-ss")}.xlsx`,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(l),Y.success("导出成功")}catch(e){console.error("导出失败:",e),Y.error("导出失败")}},Qe=e=>{He.value=e},ea=()=>{0!==He.value.length?Y.success(`正在批量执行 ${He.value.length} 个测试用例`):Y.warning("请选择要执行的测试用例")},aa=()=>{0!==He.value.length?B.confirm(`确定要删除选中的 ${He.value.length} 个测试用例吗？此操作不可恢复。`,"确认批量删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=He.value.map(e=>e.id),a=await X(e);a.success?(Y.success("批量删除成功"),Se(),Je()):Y.error(a.message||"批量删除失败")}catch(e){console.error("批量删除失败:",e),Y.error("批量删除失败")}}):Y.warning("请选择要删除的测试用例")},la=async()=>{if(Te.value)try{let e;await Te.value.validate(),Be.value=!0,e=Le.value?await G(Ae.id,Ae):await Q(Ae),e.success?(Y.success(Le.value?"更新成功":"创建成功"),De.value=!1,Se(),Je()):Y.error(e.message||"操作失败")}catch(e){console.error("提交失败:",e),Y.error("操作失败")}finally{Be.value=!1}},ta=()=>{Object.assign(Ae,{id:null,name:"",module:"",priority:"medium",preconditions:"",steps:"",expected_result:"",remarks:""}),Te.value&&Te.value.resetFields()},sa=e=>{Ne.size=e,Ne.page=1,Se()},oa=e=>{Ne.page=e,Se()},da=e=>({login:"登录模块",user:"用户管理",device:"设备管理",test:"测试管理"}[e]||e),ra=e=>({login:"primary",user:"success",device:"warning",test:"info"}[e]||"info"),ua=e=>({high:"高",medium:"中",low:"低"}[e]||e),ia=e=>({high:"danger",medium:"warning",low:"success"}[e]||"info"),na=e=>({passed:"通过",failed:"失败",pending:"待执行",not_applicable:"不适用"}[e]||e),ca=e=>({passed:"success",failed:"danger",pending:"warning",not_applicable:"info"}[e]||"info"),pa=e=>e?ee(e).format("YYYY-MM-DD HH:mm:ss"):"-",ma=e=>{"reviews"===e.paneName&&(window.location.href="/test-cases/case-reviews")};return h(()=>{Se(),Je()}),(g,y)=>{const h=b,J=_,P=N,W=D,X=v,G=f,Q=S,ee=m,ae=n,ta=c,fa=p,va=u,_a=i,ba=d,ga=r,ya=s,ha=o,wa=t,Va=a,Ca=l,ka=e;return w(),V("div",le,[C("div",te,[y[18]||(y[18]=C("div",{class:"header-content"},[C("h1",null,"测试用例管理"),C("p",{class:"description"},"管理和执行测试用例")],-1)),C("div",se,[k(J,{modelValue:Me.value,"onUpdate:modelValue":y[0]||(y[0]=e=>Me.value=e),onTabClick:ma},{default:j(()=>[k(h,{label:"用例列表",name:"list"}),k(h,{label:"用例评审",name:"reviews"})]),_:1},8,["modelValue"])]),C("div",oe,[k(W,{type:"primary",onClick:Xe},{default:j(()=>[k(P,null,{default:j(()=>[k(q(L))]),_:1}),y[15]||(y[15]=O(" 新建用例 ",-1))]),_:1}),k(W,{onClick:Ze},{default:j(()=>[k(P,null,{default:j(()=>[k(q(T))]),_:1}),y[16]||(y[16]=O(" 导入用例 ",-1))]),_:1}),k(W,{onClick:Ge},{default:j(()=>[k(P,null,{default:j(()=>[k(q($))]),_:1}),y[17]||(y[17]=O(" 导出用例 ",-1))]),_:1})])]),C("div",de,[k(G,{gutter:20},{default:j(()=>[k(X,{span:6},{default:j(()=>[C("div",re,[C("div",ue,[k(P,null,{default:j(()=>[k(q(H))]),_:1})]),C("div",ie,[C("div",ne,z(Re.total),1),y[19]||(y[19]=C("div",{class:"stat-label"},"用例总数",-1))])])]),_:1}),k(X,{span:6},{default:j(()=>[C("div",ce,[C("div",pe,[k(P,null,{default:j(()=>[k(q(M))]),_:1})]),C("div",me,[C("div",fe,z(Re.passed),1),y[20]||(y[20]=C("div",{class:"stat-label"},"通过用例",-1))])])]),_:1}),k(X,{span:6},{default:j(()=>[C("div",ve,[C("div",_e,[k(P,null,{default:j(()=>[k(q(R))]),_:1})]),C("div",be,[C("div",ge,z(Re.failed),1),y[21]||(y[21]=C("div",{class:"stat-label"},"失败用例",-1))])])]),_:1}),k(X,{span:6},{default:j(()=>[C("div",ye,[C("div",he,[k(P,null,{default:j(()=>[k(q(I))]),_:1})]),C("div",we,[C("div",Ve,z(Re.pending),1),y[22]||(y[22]=C("div",{class:"stat-label"},"待执行用例",-1))])])]),_:1})]),_:1})]),C("div",Ce,[k(fa,{model:Ie,inline:""},{default:j(()=>[k(ee,{label:"用例名称"},{default:j(()=>[k(Q,{modelValue:Ie.name,"onUpdate:modelValue":y[1]||(y[1]=e=>Ie.name=e),placeholder:"请输入用例名称",clearable:"",onClear:Pe,onKeyup:A(Pe,["enter"])},null,8,["modelValue"])]),_:1}),k(ee,{label:"模块"},{default:j(()=>[k(ta,{modelValue:Ie.module,"onUpdate:modelValue":y[2]||(y[2]=e=>Ie.module=e),placeholder:"请选择模块",clearable:"",onClear:Pe,onChange:Pe},{default:j(()=>[k(ae,{label:"登录模块",value:"login"}),k(ae,{label:"用户管理",value:"user"}),k(ae,{label:"设备管理",value:"device"}),k(ae,{label:"测试管理",value:"test"})]),_:1},8,["modelValue"])]),_:1}),k(ee,{label:"优先级"},{default:j(()=>[k(ta,{modelValue:Ie.priority,"onUpdate:modelValue":y[3]||(y[3]=e=>Ie.priority=e),placeholder:"请选择优先级",clearable:"",onClear:Pe,onChange:Pe},{default:j(()=>[k(ae,{label:"高",value:"high"}),k(ae,{label:"中",value:"medium"}),k(ae,{label:"低",value:"low"})]),_:1},8,["modelValue"])]),_:1}),k(ee,{label:"状态"},{default:j(()=>[k(ta,{modelValue:Ie.status,"onUpdate:modelValue":y[4]||(y[4]=e=>Ie.status=e),placeholder:"请选择状态",clearable:"",onClear:Pe,onChange:Pe},{default:j(()=>[k(ae,{label:"通过",value:"passed"}),k(ae,{label:"失败",value:"failed"}),k(ae,{label:"待执行",value:"pending"}),k(ae,{label:"跳过",value:"skipped"})]),_:1},8,["modelValue"])]),_:1}),k(ee,null,{default:j(()=>[k(W,{type:"primary",onClick:Pe},{default:j(()=>[k(P,null,{default:j(()=>[k(q(F))]),_:1}),y[23]||(y[23]=O(" 搜索 ",-1))]),_:1}),k(W,{onClick:We},{default:j(()=>[k(P,null,{default:j(()=>[k(q(K))]),_:1}),y[24]||(y[24]=O(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),C("div",ke,[x((w(),U(ba,{data:Ke.value,stripe:"",border:"",style:{width:"100%"},onSelectionChange:Qe},{default:j(()=>[k(va,{type:"selection",width:"55"}),k(va,{prop:"id",label:"ID",width:"80"}),k(va,{prop:"name",label:"用例名称","min-width":"200","show-overflow-tooltip":""}),k(va,{prop:"module",label:"模块",width:"100"},{default:j(({row:e})=>[k(_a,{type:ra(e.module)},{default:j(()=>[O(z(da(e.module)),1)]),_:2},1032,["type"])]),_:1}),k(va,{prop:"priority",label:"优先级",width:"80"},{default:j(({row:e})=>[k(_a,{type:ia(e.priority)},{default:j(()=>[O(z(ua(e.priority)),1)]),_:2},1032,["type"])]),_:1}),k(va,{prop:"status",label:"状态",width:"80"},{default:j(({row:e})=>[k(_a,{type:ca(e.status)},{default:j(()=>[O(z(na(e.status)),1)]),_:2},1032,["type"])]),_:1}),k(va,{prop:"creator",label:"创建者",width:"100"}),k(va,{prop:"created_at",label:"创建时间",width:"160"},{default:j(({row:e})=>[O(z(pa(e.created_at)),1)]),_:1}),k(va,{prop:"updated_at",label:"更新时间",width:"160"},{default:j(({row:e})=>[O(z(pa(e.updated_at)),1)]),_:1}),k(va,{label:"操作",width:"250",fixed:"right"},{default:j(({row:e})=>[k(W,{type:"primary",size:"small",onClick:a=>(e=>{$e.value=e,qe.value=!0})(e)},{default:j(()=>[...y[25]||(y[25]=[O(" 查看 ",-1)])]),_:1},8,["onClick"]),k(W,{type:"success",size:"small",onClick:a=>(e=>{Y.success(`正在执行测试用例: ${e.name}`)})(e)},{default:j(()=>[...y[26]||(y[26]=[O(" 执行 ",-1)])]),_:1},8,["onClick"]),k(W,{type:"warning",size:"small",onClick:a=>(e=>{Le.value=!0,Oe.value="编辑测试用例",De.value=!0,Object.assign(Ae,{id:e.id,name:e.name,module:e.module,priority:e.priority,preconditions:e.preconditions,steps:e.steps,expected_result:e.expected_result,remarks:e.remarks})})(e)},{default:j(()=>[...y[27]||(y[27]=[O(" 编辑 ",-1)])]),_:1},8,["onClick"]),k(W,{type:"danger",size:"small",onClick:a=>(e=>{B.confirm(`确定要删除测试用例 "${e.name}" 吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const a=await Z(e.id);a.success?(Y.success("删除成功"),Se(),Je()):Y.error(a.message||"删除失败")}catch(a){console.error("删除测试用例失败:",a),Y.error("删除失败")}})})(e)},{default:j(()=>[...y[28]||(y[28]=[O(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ka,Ye.value]]),He.value.length>0?(w(),V("div",je,[C("span",null,"已选择 "+z(He.value.length)+" 项",1),k(W,{type:"success",onClick:ea},{default:j(()=>[...y[29]||(y[29]=[O(" 批量执行 ",-1)])]),_:1}),k(W,{type:"danger",onClick:aa},{default:j(()=>[...y[30]||(y[30]=[O(" 批量删除 ",-1)])]),_:1})])):E("",!0),C("div",xe,[k(ga,{"current-page":"pagination.page","page-size":"pagination.size",total:Ne.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:sa,onCurrentChange:oa},null,8,["total"])])]),k(wa,{modelValue:De.value,"onUpdate:modelValue":y[13]||(y[13]=e=>De.value=e),title:Oe.value,width:"800px","close-on-click-modal":!1},{footer:j(()=>[C("span",Ue,[k(W,{onClick:y[12]||(y[12]=e=>De.value=!1)},{default:j(()=>[...y[34]||(y[34]=[O("取消",-1)])]),_:1}),k(W,{type:"primary",loading:Be.value,onClick:la},{default:j(()=>[...y[35]||(y[35]=[O(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:j(()=>[k(fa,{ref_key:"testCaseFormRef",ref:Te,model:Ae,rules:Fe,"label-width":"100px"},{default:j(()=>[k(ee,{label:"用例名称",prop:"name"},{default:j(()=>[k(Q,{modelValue:Ae.name,"onUpdate:modelValue":y[5]||(y[5]=e=>Ae.name=e),placeholder:"请输入用例名称"},null,8,["modelValue"])]),_:1}),k(ee,{label:"所属模块",prop:"module"},{default:j(()=>[k(ta,{modelValue:Ae.module,"onUpdate:modelValue":y[6]||(y[6]=e=>Ae.module=e),placeholder:"请选择模块"},{default:j(()=>[k(ae,{label:"登录模块",value:"login"}),k(ae,{label:"用户管理",value:"user"}),k(ae,{label:"设备管理",value:"device"}),k(ae,{label:"测试管理",value:"test"})]),_:1},8,["modelValue"])]),_:1}),k(ee,{label:"优先级",prop:"priority"},{default:j(()=>[k(ha,{modelValue:Ae.priority,"onUpdate:modelValue":y[7]||(y[7]=e=>Ae.priority=e)},{default:j(()=>[k(ya,{label:"high"},{default:j(()=>[...y[31]||(y[31]=[O("高",-1)])]),_:1}),k(ya,{label:"medium"},{default:j(()=>[...y[32]||(y[32]=[O("中",-1)])]),_:1}),k(ya,{label:"low"},{default:j(()=>[...y[33]||(y[33]=[O("低",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),k(ee,{label:"前置条件",prop:"preconditions"},{default:j(()=>[k(Q,{modelValue:Ae.preconditions,"onUpdate:modelValue":y[8]||(y[8]=e=>Ae.preconditions=e),type:"textarea",rows:3,placeholder:"请输入前置条件"},null,8,["modelValue"])]),_:1}),k(ee,{label:"测试步骤",prop:"steps"},{default:j(()=>[k(Q,{modelValue:Ae.steps,"onUpdate:modelValue":y[9]||(y[9]=e=>Ae.steps=e),type:"textarea",rows:5,placeholder:"请输入测试步骤，每行一个步骤"},null,8,["modelValue"])]),_:1}),k(ee,{label:"预期结果",prop:"expected_result"},{default:j(()=>[k(Q,{modelValue:Ae.expected_result,"onUpdate:modelValue":y[10]||(y[10]=e=>Ae.expected_result=e),type:"textarea",rows:3,placeholder:"请输入预期结果"},null,8,["modelValue"])]),_:1}),k(ee,{label:"备注",prop:"remarks"},{default:j(()=>[k(Q,{modelValue:Ae.remarks,"onUpdate:modelValue":y[11]||(y[11]=e=>Ae.remarks=e),type:"textarea",rows:2,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),k(wa,{modelValue:qe.value,"onUpdate:modelValue":y[14]||(y[14]=e=>qe.value=e),title:"测试用例详情",width:"800px"},{default:j(()=>[$e.value?(w(),V("div",ze,[k(Ca,{column:2,border:""},{default:j(()=>[k(Va,{label:"用例ID"},{default:j(()=>[O(z($e.value.id),1)]),_:1}),k(Va,{label:"用例名称"},{default:j(()=>[O(z($e.value.name),1)]),_:1}),k(Va,{label:"所属模块"},{default:j(()=>[k(_a,{type:ra($e.value.module)},{default:j(()=>[O(z(da($e.value.module)),1)]),_:1},8,["type"])]),_:1}),k(Va,{label:"优先级"},{default:j(()=>[k(_a,{type:ia($e.value.priority)},{default:j(()=>[O(z(ua($e.value.priority)),1)]),_:1},8,["type"])]),_:1}),k(Va,{label:"状态"},{default:j(()=>[k(_a,{type:ca($e.value.status)},{default:j(()=>[O(z(na($e.value.status)),1)]),_:1},8,["type"])]),_:1}),k(Va,{label:"创建者"},{default:j(()=>[O(z($e.value.creator),1)]),_:1}),k(Va,{label:"创建时间"},{default:j(()=>[O(z(pa($e.value.created_at)),1)]),_:1}),k(Va,{label:"更新时间"},{default:j(()=>[O(z(pa($e.value.updated_at)),1)]),_:1}),k(Va,{label:"前置条件",span:2},{default:j(()=>[O(z($e.value.preconditions||"-"),1)]),_:1}),k(Va,{label:"测试步骤",span:2},{default:j(()=>[C("div",Ee,z($e.value.steps),1)]),_:1}),k(Va,{label:"预期结果",span:2},{default:j(()=>[O(z($e.value.expected_result||"-"),1)]),_:1}),k(Va,{label:"备注",span:2},{default:j(()=>[O(z($e.value.remarks||"-"),1)]),_:1})]),_:1})])):E("",!0)]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-895edb9a"]]);export{Ye as default};
